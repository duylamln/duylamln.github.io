(function(t){function e(e){for(var n,i,a=e[0],c=e[1],u=e[2],l=0,d=[];l<a.length;l++)i=a[l],Object.prototype.hasOwnProperty.call(s,i)&&s[i]&&d.push(s[i][0]),s[i]=0;for(n in c)Object.prototype.hasOwnProperty.call(c,n)&&(t[n]=c[n]);m&&m(e);while(d.length)d.shift()();return o.push.apply(o,u||[]),r()}function r(){for(var t,e=0;e<o.length;e++){for(var r=o[e],n=!0,i=1;i<r.length;i++){var a=r[i];0!==s[a]&&(n=!1)}n&&(o.splice(e--,1),t=c(c.s=r[0]))}return t}var n={},i={app:0},s={app:0},o=[];function a(t){return c.p+"js/"+({}[t]||t)+"."+{"chunk-40f4cc33":"3065ab02","chunk-2d0d63f1":"73aabed3","chunk-e57b56ca":"40225c38"}[t]+".js"}function c(e){if(n[e])return n[e].exports;var r=n[e]={i:e,l:!1,exports:{}};return t[e].call(r.exports,r,r.exports,c),r.l=!0,r.exports}c.e=function(t){var e=[],r={"chunk-e57b56ca":1};i[t]?e.push(i[t]):0!==i[t]&&r[t]&&e.push(i[t]=new Promise((function(e,r){for(var n="css/"+({}[t]||t)+"."+{"chunk-40f4cc33":"31d6cfe0","chunk-2d0d63f1":"31d6cfe0","chunk-e57b56ca":"8d6a4e2b"}[t]+".css",s=c.p+n,o=document.getElementsByTagName("link"),a=0;a<o.length;a++){var u=o[a],l=u.getAttribute("data-href")||u.getAttribute("href");if("stylesheet"===u.rel&&(l===n||l===s))return e()}var d=document.getElementsByTagName("style");for(a=0;a<d.length;a++){u=d[a],l=u.getAttribute("data-href");if(l===n||l===s)return e()}var m=document.createElement("link");m.rel="stylesheet",m.type="text/css",m.onload=e,m.onerror=function(e){var n=e&&e.target&&e.target.src||s,o=new Error("Loading CSS chunk "+t+" failed.\n("+n+")");o.code="CSS_CHUNK_LOAD_FAILED",o.request=n,delete i[t],m.parentNode.removeChild(m),r(o)},m.href=s;var p=document.getElementsByTagName("head")[0];p.appendChild(m)})).then((function(){i[t]=0})));var n=s[t];if(0!==n)if(n)e.push(n[2]);else{var o=new Promise((function(e,r){n=s[t]=[e,r]}));e.push(n[2]=o);var u,l=document.createElement("script");l.charset="utf-8",l.timeout=120,c.nc&&l.setAttribute("nonce",c.nc),l.src=a(t);var d=new Error;u=function(e){l.onerror=l.onload=null,clearTimeout(m);var r=s[t];if(0!==r){if(r){var n=e&&("load"===e.type?"missing":e.type),i=e&&e.target&&e.target.src;d.message="Loading chunk "+t+" failed.\n("+n+": "+i+")",d.name="ChunkLoadError",d.type=n,d.request=i,r[1](d)}s[t]=void 0}};var m=setTimeout((function(){u({type:"timeout",target:l})}),12e4);l.onerror=l.onload=u,document.head.appendChild(l)}return Promise.all(e)},c.m=t,c.c=n,c.d=function(t,e,r){c.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},c.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},c.t=function(t,e){if(1&e&&(t=c(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(c.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)c.d(r,n,function(e){return t[e]}.bind(null,n));return r},c.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return c.d(e,"a",e),e},c.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},c.p="/chemistorder/",c.oe=function(t){throw console.error(t),t};var u=window["webpackJsonp"]=window["webpackJsonp"]||[],l=u.push.bind(u);u.push=e,u=u.slice();for(var d=0;d<u.length;d++)e(u[d]);var m=l;o.push([0,"chunk-vendors"]),r()})({0:function(t,e,r){t.exports=r("56d7")},"20d5":function(t,e,r){},"3dbb":function(t,e,r){},"56d7":function(t,e,r){"use strict";r.r(e);r("7514"),r("1c4c"),r("8a81"),r("f466"),r("579f"),r("587a");var n=r("a026"),i=r("5f5b"),s=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("router-view")},o=[],a={name:"app"},c=a,u=(r("5c0b"),r("2877")),l=Object(u["a"])(c,s,o,!1,null,null,null),d=l.exports,m=r("8c4f"),p=r("8aa5"),h=r.n(p),f=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"animated fadeIn"},[r("b-row",[r("b-col",[r("b-card",[r("div",{attrs:{slot:"header"},slot:"header"},[r("span",[r("i",{staticClass:"fa fa-book"}),t._v("\n            Products ("+t._s(t.productCount)+")\n          ")]),r("div",{staticClass:"pull-right"},[r("b-link",{on:{click:t.clearAllSalePrices}},[t._v("Clear Sale Prices |")]),r("b-link",{staticClass:"ml-1",on:{click:t.addNewProduct}},[t._v("Add New Product")])],1)]),r("b-row",[r("b-col",{attrs:{sm:"12",md:"6"}},[r("b-input-group",{staticClass:"mb-5"},[r("b-form-input",{on:{keydown:function(e){return t.seartTextKeydown(e)}},model:{value:t.searchText,callback:function(e){t.searchText=e},expression:"searchText"}}),r("b-input-group-append",[""!=t.searchText?r("span",{staticClass:"fa fa-close",attrs:{id:"searchclear"},on:{click:t.clearSearchText}}):t._e(),r("b-button",{attrs:{variant:"outline-success"},on:{click:function(e){return t.clickSearchProduct()}}},[r("span",{staticClass:"fa fa-search"}),t._v(" Search\n                ")])],1)],1)],1)],1),r("view-port",{scopedSlots:t._u([{key:"mobile",fn:function(){return[r("products-list-mobile",{attrs:{products:t.products,"search-text":t.searchText},on:{productClicked:t.productClicked,deleteProduct:t.deleteProduct,editProduct:t.editProduct}})]},proxy:!0},{key:"desktop",fn:function(){return[r("products-list",{attrs:{products:t.products,"search-text":t.searchText},on:{productClicked:t.productClicked,deleteProduct:t.deleteProduct,editProduct:t.editProduct}})]},proxy:!0}])}),r("b-row",{staticClass:"load-more"},[r("b-button",{attrs:{variant:"outline-success",disabled:t.isLoadingMore},on:{click:function(e){return t.loadMoreProduct(e)}}},[t._v("Load more")])],1)],1)],1)],1),r("product-detail",{ref:"productDetail",on:{productSaved:t.productSaved}})],1)},v=[],b=(r("7f7f"),r("cebc")),g=(r("ac6a"),function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("b-modal",{attrs:{id:t.intId,title:"Product Detail",size:"lg"},on:{ok:t.saveProduct}},[r("cw-product-predictive",{ref:"cwProductPredictive",on:{productMatched:t.updateCwMatchedProduct}}),r("b-row",[r("b-col",{attrs:{sm:"8"}},[r("b-form-group",[r("label",{attrs:{for:"name"}},[t._v("Name")]),r("b-input-group",[r("b-form-input",{attrs:{type:"text",placeholder:"Enter product name"},model:{value:t.prod.name,callback:function(e){t.$set(t.prod,"name",e)},expression:"prod.name"}}),r("b-input-group-append",[r("b-button",{attrs:{variant:"outline-info"},on:{click:t.checkCwMatchedProduct}},[t._v("Check")])],1)],1)],1),r("b-form-group",[r("label",{attrs:{for:"name"}},[t._v("Thumbnail Url")]),r("b-form-input",{attrs:{type:"text",placeholder:"Enter product image url"},model:{value:t.prod.thumbnail,callback:function(e){t.$set(t.prod,"thumbnail",e)},expression:"prod.thumbnail"}})],1)],1),r("b-col",{attrs:{sm:"4"}},[r("div",{staticClass:"card"},[r("img",{staticStyle:{margin:"auto"},attrs:{src:t.prod.thumbnail,alt:t.prod.name,width:"150px",height:"150px"}})])])],1),r("b-row",[r("b-col",{attrs:{sm:"4"}},[r("b-form-group",[r("label",{attrs:{for:"weight"}},[t._v("Weight (g)")]),r("b-link",{staticClass:"ml-2",on:{click:t.searchShipppingWeight}},[t._v("Search")]),r("b-form-input",{attrs:{type:"text",id:"weight",placeholder:"0"},model:{value:t.prod.weight,callback:function(e){t.$set(t.prod,"weight",e)},expression:"prod.weight"}})],1)],1),r("b-col",{attrs:{sm:"4"}},[r("b-form-group",[r("label",{attrs:{for:"shipprice"}},[t._v("Shipment Price (A$)")]),r("b-form-input",{attrs:{type:"text",id:"shipprice",placeholder:"0.00"},model:{value:t.prod.shipPrice,callback:function(e){t.$set(t.prod,"shipPrice",e)},expression:"prod.shipPrice"}})],1)],1)],1),r("fieldset",{staticClass:"my-fieldset form-group"},[r("b-row",[r("b-col",{attrs:{sm:"4"}},[r("b-form-group",[r("label",{attrs:{for:"cwprice"}},[t._v("CW Price (A$) (PID: "+t._s(t.prod.cwProductId)+")")]),r("b-form-input",{attrs:{type:"text",id:"cwprice",placeholder:"0.00"},model:{value:t.prod.cwPrice,callback:function(e){t.$set(t.prod,"cwPrice",e)},expression:"prod.cwPrice"}})],1)],1),r("b-col",{attrs:{sm:"4"}},[r("b-form-group",[r("label",[r("b-form-checkbox",{on:{change:t.cwSalePricePickChanged},model:{value:t.prod.cwSalePricePick,callback:function(e){t.$set(t.prod,"cwSalePricePick",e)},expression:"prod.cwSalePricePick"}},[t._v("CW Sale Price (A$)")])],1),r("b-form-input",{attrs:{type:"text",id:"buyprice",placeholder:"0.00"},model:{value:t.prod.cwSalePrice,callback:function(e){t.$set(t.prod,"cwSalePrice",e)},expression:"prod.cwSalePrice"}})],1)],1),r("b-col",{attrs:{sm:"4"}},[r("div",{staticClass:"form-group"},[r("label",[t._v("Expired Sale")]),r("date-pick",{attrs:{format:"DD.MM.YYYY",editable:t.prod.cwSalePricePick},model:{value:t.prod.cwExpiredSale,callback:function(e){t.$set(t.prod,"cwExpiredSale",e)},expression:"prod.cwExpiredSale"}})],1)])],1)],1),r("fieldset",{staticClass:"my-fieldset form-group"},[r("b-row",[r("b-col",{attrs:{sm:"4"}},[r("b-form-group",[r("label",{attrs:{for:"bvprice"}},[t._v("BV Price (A$)")]),r("b-form-input",{attrs:{type:"text",id:"bvprice",placeholder:"0.00"},model:{value:t.prod.bvPrice,callback:function(e){t.$set(t.prod,"bvPrice",e)},expression:"prod.bvPrice"}})],1)],1),r("b-col",{attrs:{sm:"4"}},[r("b-form-group",[r("label",[r("b-form-checkbox",{on:{change:t.bvSalePricePickChanged},model:{value:t.prod.bvSalePricePick,callback:function(e){t.$set(t.prod,"bvSalePricePick",e)},expression:"prod.bvSalePricePick"}},[t._v("BV Sale Price (A$)")])],1),r("b-form-input",{attrs:{type:"text",id:"bvsaleprice",placeholder:"0.00"},model:{value:t.prod.bvSalePrice,callback:function(e){t.$set(t.prod,"bvSalePrice",e)},expression:"prod.bvSalePrice"}})],1)],1),r("b-col",{attrs:{sm:"4"}},[r("div",{staticClass:"form-group"},[r("label",[t._v("Expired Sale")]),r("date-pick",{attrs:{format:"DD.MM.YYYY",editable:t.prod.bvSalePricePick},model:{value:t.prod.bvExpiredSale,callback:function(e){t.$set(t.prod,"bvExpiredSale",e)},expression:"prod.bvExpiredSale"}})],1)])],1)],1),r("b-row",[r("b-col",{attrs:{sm:"4"}}),r("b-col",{attrs:{sm:"4"}},[r("b-form-group",[r("label",{attrs:{for:"selprice"}},[t._v("Selling Price (A$)")]),r("b-form-input",{attrs:{type:"text",id:"selprice",placeholder:"0.00"},model:{value:t.prod.selPrice,callback:function(e){t.$set(t.prod,"selPrice",e)},expression:"prod.selPrice"}})],1)],1),r("b-col",{attrs:{sm:"4"}},[r("b-form-group",[r("label",{attrs:{for:"buyprice"}},[t._v("Buying Price (A$)")]),r("b-form-input",{attrs:{type:"text",id:"buyprice",placeholder:"0.00"},model:{value:t.prod.buyPrice,callback:function(e){t.$set(t.prod,"buyPrice",e)},expression:"prod.buyPrice"}})],1)],1)],1),r("b-row",[r("b-col",{attrs:{sm:"4"}},[r("b-form-group",{attrs:{description:"Buy. Price + Ship"}},[r("label",{attrs:{for:"oriprice"}},[t._v("Ori. Price (A$)")]),t._v(" -\n        "),r("vnd-price",{attrs:{value:t.prod.oriPrice}}),r("b-form-input",{attrs:{type:"text",id:"oriprice",placeholder:"0.00"},model:{value:t.prod.oriPrice,callback:function(e){t.$set(t.prod,"oriPrice",e)},expression:"prod.oriPrice"}})],1)],1),r("b-col",{attrs:{sm:"4"}},[r("b-form-group",{attrs:{description:"Sel. Price + Commission(10%) + Ship + $2"}},[r("label",{attrs:{for:"sugprice"}},[t._v("\n          Sug. Price (A$) -\n          "),r("vnd-price",{attrs:{value:t.prod.sugPrice}})],1),r("b-form-input",{attrs:{placeholder:"0.00"},model:{value:t.prod.sugPrice,callback:function(e){t.$set(t.prod,"sugPrice",e)},expression:"prod.sugPrice"}})],1)],1),r("b-col",{attrs:{sm:"4"}},[r("b-form-group",[r("label",{attrs:{for:"rndprice"}},[t._v("\n          Rnd. Price (VND) -\n          "),r("i",{staticStyle:{color:"red"}},[t._v(t._s(t._f("currency")(t.prod.rndPrice,t.vndConfig)))])]),r("b-form-input",{attrs:{type:"text",placeholder:"0.00"},model:{value:t.prod.rndPrice,callback:function(e){t.$set(t.prod,"rndPrice",e)},expression:"prod.rndPrice"}})],1)],1)],1)],1)}),y=[],C=(r("a481"),{commissionRate:1.1,vndExchageRate:16500,ctvCommissionRate:1.08,buyingFee:2}),k={priceSettings:C},P=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("span",{staticStyle:{color:"red"}},[r("i",[t._v(t._s(t._f("currency")(t.display,t.vndConfig)))])])},w=[],x=k.priceSettings,S={name:"vndPrice",props:["value"],mounted:function(){},computed:{display:function(){return parseFloat(this.value)*parseFloat(x.vndExchageRate)}}},I=S,O=Object(u["a"])(I,P,w,!1,null,null,null),$=O.exports;r("28a5");function T(t){var e=t.split(" "),r=[];return e.forEach((function(t){var e="";t.split("").forEach((function(t){e+=t.toLowerCase(),r.push(e)}))})),r}Date.prototype.setMin=function(){return this.setHours(0),this.setMinutes(0),this.setSeconds(0),this.setMilliseconds(0),this};var D=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("b-row",[r("b-col",{attrs:{sm:"12"}},[r("div",{staticClass:"alert alert-primary",staticStyle:{padding:"5px"},attrs:{role:"alert"}},[t.isChecking?[r("div",{staticClass:"spinner-border spinner-border-sm text-success",attrs:{role:"status"}},[r("span",{staticClass:"sr-only"})]),t._v("  Checking CW Price...\n      ")]:t._e(),t.isChecking?t._e():[0==t.matchedProducts.length?[t._v("Not found")]:[r("div",[r("p",[t._v("Last Checked: "+t._s(t._f("date")(t.lastChecked)))]),r("table",{staticClass:"table table-borderless"},t._l(t.matchedProducts,(function(e,n){return r("tr",{key:n},[r("view-port",{scopedSlots:t._u([{key:"desktop",fn:function(){return[r("td",{staticStyle:{width:"10%"}},[t._v("#"+t._s(e.id))]),r("td",[t._v(t._s(e.label))]),r("td",{staticClass:"text-center"},[r("small",[r("del",[t._v(t._s(t._f("currency")(e.oldPrice,t.audConfig)))])]),t._v("\n                      "+t._s(t._f("currency")(e.price,t.audConfig))+"\n                      "),"increase"==e.priceStatus?r("i",{staticClass:"fa fa-angle-double-up fa-lg",staticStyle:{color:"red"},attrs:{"aria-hidden":"true"}}):t._e(),"decrease"==e.priceStatus?r("i",{staticClass:"fa fa-angle-double-down fa-lg",staticStyle:{color:"green"},attrs:{"aria-hidden":"true"}}):t._e(),t._v("\n                      ("+t._s(e.percentage)+"%)\n                    ")]),r("td",{staticClass:"text-right"},[r("b-button",{attrs:{type:"submit",size:"sm",variant:"success",disabled:t.selected.id==e.id},on:{click:function(r){return t.matchProduct(e)}}},[r("i",{staticClass:"fa fa-check"}),t._v(" Select\n                      ")])],1)]},proxy:!0},{key:"mobile",fn:function(){return[r("td",{staticStyle:{width:"100%"}},[t._v("\n                      "+t._s(n+1)+". "+t._s(e.label)+" (#"+t._s(e.id)+")\n                      -\n                      "),r("small",[r("del",[t._v(t._s(t._f("currency")(e.oldPrice,t.audConfig)))])]),t._v("\n                      "+t._s(t._f("currency")(e.price,t.audConfig))+"\n                      "),"increase"==e.priceStatus?r("i",{staticClass:"fa fa-angle-double-up fa-lg",staticStyle:{color:"red"},attrs:{"aria-hidden":"true"}}):t._e(),"decrease"==e.priceStatus?r("i",{staticClass:"fa fa-angle-double-down fa-lg",staticStyle:{color:"green"},attrs:{"aria-hidden":"true"}}):t._e(),t._v("\n                      ("+t._s(e.percentage)+"%)\n                      "),r("br"),r("b-button",{attrs:{type:"submit",size:"sm",variant:"success",disabled:t.selected.id==e.id},on:{click:function(r){return t.matchProduct(e)}}},[r("i",{staticClass:"fa fa-check"}),t._v(" Select\n                      ")])],1)]},proxy:!0}],null,!0)})],1)})),0)])]]],2)])],1)},E=[];n["default"].appSettings;var M=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[t.useMobileView?t._t("mobile",[t._v("This is mobile view")]):t._e(),t.useMobileView?t._e():t._t("desktop",[t._v("This is desktop view")])],2)},F=[],L={name:"viewPort",props:[],data:function(){return{useMobileView:!1,innerWidth:0}},mounted:function(){var t=this;t.useMobileView=window.innerWidth<700,t.innerWidth=window.innerWidth,window.addEventListener("resize",(function(){t.useMobileView=window.innerWidth<700,t.innerWidth=window.innerWidth}))},computed:{}},R=L,A=Object(u["a"])(R,M,F,!1,null,null,null),B=A.exports,j={name:"cwProductPredictive",components:{viewPort:B},props:[],data:function(){return{matchedProducts:[],isChecking:!1,hasChanged:!1,product:{},lastChecked:void 0,selected:{}}},mounted:function(){},watch:{},computed:{},methods:{checkPrice:function(t,e){var r=this;if(this.product=t,this.selected={},this.matchedProducts=[],this.product&&this.product.name){var n=(new Date).setMin(),i=this.product,s=i.cwProductId,o=i.name,a=i.cwTracking;if(!e&&a&&a.lastChecked&&a.lastChecked.toDate()>n)return this.matchedProducts.push({id:this.product.cwProductId,priceStatus:a.priceStatus,price:a.price,oldPrice:a.oldPrice,percentage:a.percentage,label:this.product.name}),void(this.lastChecked=a.lastChecked.toDate());var c=s||o;this.isChecking=!0,this.hasChanged=!1,this.$http.get(this.appSettings.cwCheckPriceApi.replace("{term}",c)).then((function(t){if(t&&200==t.status&&t.data){var e=t.data,n=_.filter(e,(function(t){return parseFloat(t.id)>0}));n&&(n=_.map(n,r.decorateData),n.forEach((function(t){return r.matchedProducts.push(t)}))),r.hasChanged=_.some(r.matchedProducts,{hasChanged:!0})}r.lastChecked=new Date,r.isChecking=!1}))}},decorateData:function(t){t.price=parseFloat(t.Price),t.thumbnail=this.appSettings.cwProductThumbnailUrl150.replace("{id}",t.id);var e=t.price,r=parseFloat(this.product.cwPrice);return t.oldPrice=r,e>r+.5?(t.priceStatus="increase",t.percentage=((e-r)/r*100).toFixed(0)):e<r-.5?(t.priceStatus="decrease",t.percentage=((r-e)/r*100).toFixed(0)):(t.priceStatus="same",t.percentage=0),t.hasChanged=t.thumbnail!=this.product.thumbnail||"same"!=t.priceStatus,t},matchProduct:function(t){this.selected=t,this.$emit("productMatched",Object(b["a"])({},t))}}},N=j,q=Object(u["a"])(N,D,E,!1,null,null,null),Q=q.exports,V=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"vdpComponent",class:{vdpWithInput:t.hasInputElement},staticStyle:{width:"100%"}},[t.hasInputElement?r("input",t._b({staticClass:"form-control",attrs:{type:"text",readonly:t.isReadOnly},domProps:{value:t.inputValue},on:{input:function(e){t.editable&&t.processUserInput(e.target.value)},focus:function(e){t.editable&&t.open()},click:function(e){t.editable&&t.open()}}},"input",t.inputAttributes,!1)):t._e(),t.editable&&t.hasInputElement&&t.inputValue?r("button",{staticClass:"vdpClearInput",attrs:{type:"button"},on:{click:t.clear}}):t._e(),r("transition",{attrs:{name:"vdp-toggle-calendar"}},[t.opened?r("div",{ref:"outerWrap",staticClass:"vdpOuterWrap",class:[t.positionClass,{vdpFloating:t.hasInputElement}],on:{click:t.closeViaOverlay}},[r("div",{staticClass:"vdpInnerWrap"},[r("header",{staticClass:"vdpHeader"},[r("button",{staticClass:"vdpArrow vdpArrowPrev",attrs:{title:t.prevMonthCaption,type:"button"},on:{click:function(e){return t.incrementMonth(-1)}}},[t._v(t._s(t.prevMonthCaption))]),r("button",{staticClass:"vdpArrow vdpArrowNext",attrs:{type:"button",title:t.nextMonthCaption},on:{click:function(e){return t.incrementMonth(1)}}},[t._v(t._s(t.nextMonthCaption))]),r("div",{staticClass:"vdpPeriodControls"},[r("div",{staticClass:"vdpPeriodControl"},[r("button",{key:t.currentPeriod.month,class:t.directionClass,attrs:{type:"button"}},[t._v(t._s(t.months[t.currentPeriod.month]))]),r("select",{directives:[{name:"model",rawName:"v-model",value:t.currentPeriod.month,expression:"currentPeriod.month"}],on:{change:function(e){var r=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(t.currentPeriod,"month",e.target.multiple?r:r[0])}}},t._l(t.months,(function(e,n){return r("option",{key:e,domProps:{value:n}},[t._v(t._s(e))])})),0)]),r("div",{staticClass:"vdpPeriodControl"},[r("button",{key:t.currentPeriod.year,class:t.directionClass,attrs:{type:"button"}},[t._v(t._s(t.currentPeriod.year))]),r("select",{directives:[{name:"model",rawName:"v-model",value:t.currentPeriod.year,expression:"currentPeriod.year"}],on:{change:function(e){var r=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(t.currentPeriod,"year",e.target.multiple?r:r[0])}}},t._l(t.yearRange,(function(e){return r("option",{key:e,domProps:{value:e}},[t._v(t._s(e))])})),0)])])]),r("table",{staticClass:"vdpTable"},[r("thead",[r("tr",t._l(t.weekdaysSorted,(function(e){return r("th",{key:e,staticClass:"vdpHeadCell"},[r("span",{staticClass:"vdpHeadCellContent"},[t._v(t._s(e))])])})),0)]),r("tbody",{key:t.currentPeriod.year+"-"+t.currentPeriod.month,class:t.directionClass},t._l(t.currentPeriodDates,(function(e,n){return r("tr",{key:n,staticClass:"vdpRow"},t._l(e,(function(e){return r("td",{key:e.dateKey,staticClass:"vdpCell",class:{selectable:!e.disabled,selected:e.selected,disabled:e.disabled,today:e.today,outOfRange:e.outOfRange},attrs:{"data-id":e.dateKey},on:{click:function(r){return t.selectDateItem(e)}}},[r("div",{staticClass:"vdpCellContent"},[t._v(t._s(e.date.getDate()))])])})),0)})),0)]),t.pickTime&&t.currentTime?r("div",{staticClass:"vdpTimeControls"},[r("span",{staticClass:"vdpTimeCaption"},[t._v(t._s(t.setTimeCaption))]),r("div",{staticClass:"vdpTimeUnit"},[r("pre",[r("span",[t._v(t._s(t.currentTime.hoursPadded))]),r("br")]),r("input",{staticClass:"vdpHoursInput",attrs:{type:"number",pattern:"\\d*"},domProps:{value:t.currentTime.hoursPadded},on:{input:function(e){return e.preventDefault(),t.inputTime("setHours",e)}}})]),t.pickMinutes?r("span",{staticClass:"vdpTimeSeparator"},[t._v(":")]):t._e(),t.pickMinutes?r("div",{staticClass:"vdpTimeUnit"},[r("pre",[r("span",[t._v(t._s(t.currentTime.minutesPadded))]),r("br")]),t.pickMinutes?r("input",{staticClass:"vdpMinutesInput",attrs:{type:"number",pattern:"\\d*"},domProps:{value:t.currentTime.minutesPadded},on:{input:function(e){return t.inputTime("setMinutes",e)}}}):t._e()]):t._e(),t.pickSeconds?r("span",{staticClass:"vdpTimeSeparator"},[t._v(":")]):t._e(),t.pickSeconds?r("div",{staticClass:"vdpTimeUnit"},[r("pre",[r("span",[t._v(t._s(t.currentTime.secondsPadded))]),r("br")]),t.pickSeconds?r("input",{staticClass:"vdpSecondsInput",attrs:{type:"number",pattern:"\\d*"},domProps:{value:t.currentTime.secondsPadded},on:{input:function(e){return t.inputTime("setSeconds",e)}}}):t._e()]):t._e()]):t._e()])]):t._e()])],1)},z=[],W=(r("6b54"),r("768b")),U=(r("4917"),r("c5f6"),/,|\.|-| |:|\/|\\/),H=/D+/,Y=/M+/,K=/Y+/,J=/h+/i,G=/m+/,X=/s+/,Z={props:{value:{type:String,default:""},format:{type:String,default:"YYYY-MM-DD"},displayFormat:{type:String},editable:{type:Boolean,default:!0},hasInputElement:{type:Boolean,default:!0},inputAttributes:{type:Object},selectableYearRange:{type:Number,default:40},parseDate:{type:Function},formatDate:{type:Function},pickTime:{type:Boolean,default:!1},pickMinutes:{type:Boolean,default:!0},pickSeconds:{type:Boolean,default:!1},isDateDisabled:{type:Function,default:function(){return!1}},nextMonthCaption:{type:String,default:"Next month"},prevMonthCaption:{type:String,default:"Previous month"},setTimeCaption:{type:String,default:"Set time:"},mobileBreakpointWidth:{type:Number,default:500},weekdays:{type:Array,default:function(){return["Mon","Tue","Wed","Thu","Fri","Sat","Sun"]}},months:{type:Array,default:function(){return["January","February","March","April","May","June","July","August","September","October","November","December"]}},startWeekOnSunday:{type:Boolean,default:!1}},data:function(){return{inputValue:this.valueToInputFormat(this.value),currentPeriod:this.getPeriodFromValue(this.value,this.format),direction:void 0,positionClass:void 0,opened:!this.hasInputElement}},computed:{valueDate:function(){var t=this.value,e=this.format;return t?this.parseDateString(t,e):void 0},isReadOnly:function(){return!this.editable||this.inputAttributes&&this.inputAttributes.readonly},isValidValue:function(){var t=this.valueDate;return!this.value||Boolean(t)},currentPeriodDates:function(){var t=this,e=this.currentPeriod,r=e.year,n=e.month,i=[],s=new Date(r,n,1),o=new Date,a=this.startWeekOnSunday?1:0,c=s.getDay()||7;if(c>1-a)for(var u=c-(2-a);u>=0;u--){var l=new Date(s);l.setDate(-u),i.push({outOfRange:!0,date:l})}while(s.getMonth()===n)i.push({date:new Date(s)}),s.setDate(s.getDate()+1);for(var d=7-i.length%7,m=1;m<=d;m++){var p=new Date(s);p.setDate(m),i.push({outOfRange:!0,date:p})}return i.forEach((function(e){e.disabled=t.isDateDisabled(e.date),e.today=rt(e.date,o),e.dateKey=[e.date.getFullYear(),e.date.getMonth()+1,e.date.getDate()].join("-"),e.selected=!!t.valueDate&&rt(e.date,t.valueDate)})),et(i,7)},yearRange:function(){for(var t=[],e=this.currentPeriod.year,r=e-this.selectableYearRange,n=e+this.selectableYearRange,i=r;i<=n;i++)t.push(i);return t},currentTime:function(){var t=this.valueDate;return t?{hours:t.getHours(),minutes:t.getMinutes(),seconds:t.getSeconds(),hoursPadded:tt(t.getHours(),1),minutesPadded:tt(t.getMinutes(),2),secondsPadded:tt(t.getSeconds(),2)}:void 0},directionClass:function(){return this.direction?"vdp".concat(this.direction,"Direction"):void 0},weekdaysSorted:function(){if(this.startWeekOnSunday){var t=this.weekdays.slice();return t.unshift(t.pop()),t}return this.weekdays}},watch:{value:function(t){this.isValidValue&&(this.inputValue=this.valueToInputFormat(t),this.currentPeriod=this.getPeriodFromValue(t,this.format))},currentPeriod:function(t,e){var r=new Date(t.year,t.month).getTime(),n=new Date(e.year,e.month).getTime();this.direction=r!==n?r>n?"Next":"Prev":void 0}},beforeDestroy:function(){this.removeCloseEvents(),this.teardownPosition()},methods:{valueToInputFormat:function(t){return this.displayFormat&&this.formatDateToString(this.parseDateString(t,this.format),this.displayFormat)||t},getPeriodFromValue:function(t,e){var r=this.parseDateString(t,e)||new Date;return{month:r.getMonth(),year:r.getFullYear()}},parseDateString:function(t,e){return t?this.parseDate?this.parseDate(t,e):this.parseSimpleDateString(t,e):void 0},formatDateToString:function(t,e){return t?this.formatDate?this.formatDate(t,e):this.formatSimpleDateToString(t,e):""},parseSimpleDateString:function(t,e){for(var r,n,i,s,o,a,c=t.split(U),u=e.split(U),l=u.length,d=0;d<l;d++)u[d].match(H)?r=parseInt(c[d],10):u[d].match(Y)?n=parseInt(c[d],10):u[d].match(K)?i=parseInt(c[d],10):u[d].match(J)?s=parseInt(c[d],10):u[d].match(G)?o=parseInt(c[d],10):u[d].match(X)&&(a=parseInt(c[d],10));var m=new Date([tt(i,4),tt(n,2),tt(r,2)].join("-"));if(!isNaN(m)){var p=new Date(i,n-1,r);return[[i,"setFullYear"],[s,"setHours"],[o,"setMinutes"],[a,"setSeconds"]].forEach((function(t){var e=Object(W["a"])(t,2),r=e[0],n=e[1];"undefined"!==typeof r&&p[n](r)})),p}},formatSimpleDateToString:function(t,e){return e.replace(K,(function(e){return t.getFullYear()})).replace(Y,(function(e){return tt(t.getMonth()+1,e.length)})).replace(H,(function(e){return tt(t.getDate(),e.length)})).replace(J,(function(e){return tt(t.getHours(),e.length)})).replace(G,(function(e){return tt(t.getMinutes(),e.length)})).replace(X,(function(e){return tt(t.getSeconds(),e.length)}))},incrementMonth:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,e=new Date(this.currentPeriod.year,this.currentPeriod.month),r=new Date(e.getFullYear(),e.getMonth()+t);this.currentPeriod={month:r.getMonth(),year:r.getFullYear()}},processUserInput:function(t){var e=this.parseDateString(t,this.displayFormat||this.format);this.inputValue=t,this.$emit("input",e?this.formatDateToString(e,this.format):t)},open:function(){this.opened||(this.opened=!0,this.currentPeriod=this.getPeriodFromValue(this.value,this.format),this.addCloseEvents(),this.setupPosition()),this.direction=void 0},close:function(){this.opened&&(this.opened=!1,this.direction=void 0,this.removeCloseEvents(),this.teardownPosition())},closeViaOverlay:function(t){this.hasInputElement&&t.target===this.$refs.outerWrap&&this.close()},addCloseEvents:function(){var t=this;this.closeEventListener||(this.closeEventListener=function(e){return t.inspectCloseEvent(e)},["click","keyup"].forEach((function(e){return document.addEventListener(e,t.closeEventListener)})))},inspectCloseEvent:function(t){t.keyCode?27===t.keyCode&&this.close():t.target===this.$el||this.$el.contains(t.target)||this.close()},removeCloseEvents:function(){var t=this;this.closeEventListener&&(["click","keyup"].forEach((function(e){return document.removeEventListener(e,t.closeEventListener)})),delete this.closeEventListener)},setupPosition:function(){var t=this;this.positionEventListener||(this.positionEventListener=function(){return t.positionFloater()},window.addEventListener("resize",this.positionEventListener)),this.positionFloater()},positionFloater:function(){var t=this,e=this.$el.getBoundingClientRect(),r="vdpPositionTop",n="vdpPositionLeft",i=function(){var i=t.$refs.outerWrap.getBoundingClientRect(),s=i.height,o=i.width;window.innerWidth>t.mobileBreakpointWidth?(e.top+e.height+s>window.innerHeight&&e.top-s>0&&(r="vdpPositionBottom"),e.left+o>window.innerWidth&&(n="vdpPositionRight"),t.positionClass=["vdpPositionReady",r,n].join(" ")):t.positionClass="vdpPositionFixed"};this.$refs.outerWrap?i():this.$nextTick(i)},teardownPosition:function(){this.positionEventListener&&(this.positionClass=void 0,window.removeEventListener("resize",this.positionEventListener),delete this.positionEventListener)},clear:function(){this.$emit("input","")},selectDateItem:function(t){if(!t.disabled){var e=new Date(t.date);this.currentTime&&(e.setHours(this.currentTime.hours),e.setMinutes(this.currentTime.minutes),e.setSeconds(this.currentTime.seconds)),this.$emit("input",this.formatDateToString(e,this.format)),this.hasInputElement&&!this.pickTime&&this.close()}},inputTime:function(t,e){var r=this.valueDate,n={setHours:23,setMinutes:59,setSeconds:59},i=parseInt(e.target.value,10)||0;i>n[t]?i=n[t]:i<0&&(i=0),e.target.value=tt(i,"setHours"===t?1:2),r[t](i),this.$emit("input",this.formatDateToString(r,this.format))}}};function tt(t,e){return"undefined"!==typeof t?t.toString().length>e?t:new Array(e-t.toString().length+1).join("0")+t:void 0}function et(t,e){var r=[];while(t.length)r.push(t.splice(0,e));return r}function rt(t,e){return t.getDate()===e.getDate()&&t.getMonth()===e.getMonth()&&t.getFullYear()===e.getFullYear()}var nt,it,st,ot,at,ct,ut,lt=Z,dt=(r("8f38"),Object(u["a"])(lt,V,z,!1,null,null,null)),mt=dt.exports,pt=k.priceSettings,ht={name:"ProductDetail",components:{vndPrice:$,cwProductPredictive:Q,DatePick:mt},props:["id"],data:function(){return{prod:{},settings:pt,cwMatchedProduct:{},cwMatchedProductChange:!1,isCheckingCwPrice:!1}},mounted:function(){},watch:{"prod.bvPrice":function(t){this.calculatePrices()},"prod.cwPrice":function(t){this.calculatePrices()},"prod.weight":function(t){this.calculatePrices()},"prod.bvSalePrice":function(t){this.calculatePrices()},"prod.cwSalePrice":function(t){this.calculatePrices()},"prod.bvSalePricePick":function(t){this.calculatePrices()},"prod.cwSalePricePick":function(t){this.calculatePrices()}},computed:{intId:function(){return this.id||"productdetail"}},methods:{open:function(t){var e=this;this.prod=t?Object(b["a"])({},t):{},this.$bvModal.show(this.intId),this.$nextTick((function(){return e.$refs.cwProductPredictive.checkPrice(e.prod)}))},saveProduct:function(){var t=this,e=this.prod;if(e.nameSearch=T(e.name),e.name){if(e.id)return this.$fb.productCollection.doc(e.id).set(e).then((function(){return t.$emit("productSaved",Object(b["a"])({},e)),t.$bvModal.hide(t.intId),e}));var r=this.$fb.productCollection.doc();return e.id=r.id,r.set(e).then((function(){return t.$fb.counterService.increaseProduct(),t.$emit("productSaved",Object(b["a"])({},e)),t.$bvModal.hide(t.intId),e}))}},calculatePrices:function(){var t=this.prod,e=t.weight,r=t.bvPrice,n=t.cwPrice,i=t.bvSalePrice,s=t.cwSalePrice,o=t.bvSalePricePick,a=t.cwSalePricePick;this.prod.shipPrice=parseFloat(e||0)/100,this.prod.selPrice=Math.max(r||0,n||0),this.prod.buyPrice=Math.min(r||9999,n||9999),this.calculateItself(),(s||0)>0&&a&&(this.prod.selPrice=s,this.prod.buyPrice=s,this.calculateItself()),(i||0)>0&&o&&(this.prod.selPrice=i,this.prod.buyPrice=i,this.calculateItself())},calculateItself:function(){this.prod.oriPrice=(parseFloat(this.prod.shipPrice)+parseFloat(this.prod.buyPrice)).toFixed(2),this.prod.sugPrice=parseFloat(this.prod.shipPrice+this.prod.selPrice*pt.commissionRate+pt.buyingFee).toFixed(2),this.prod.sugPriceVND=parseFloat(this.prod.sugPrice*pt.vndExchageRate).toFixed(2)},bvSalePricePickChanged:function(t){t&&(this.prod.cwSalePricePick=!1)},cwSalePricePickChanged:function(t){t&&(this.prod.bvSalePricePick=!1)},updateCwMatchedProduct:function(t){var e=t.thumbnail,r=t.id,n=t.priceStatus,i=t.price,s=t.label;this.prod.name=s,this.prod.thumbnail?e&&e!=this.prod.thumbnail&&(this.prod.thumbnail=e):this.$set(this.prod,"thumbnail",e),this.prod.cwPrice?"equal"!=n&&(this.prod.cwPrice=parseFloat(i)):this.$set(this.prod,"cwPrice",i),this.prod.cwProductId?this.prod.cwProductId!=r&&(this.prod.cwProductId=r):this.$set(this.prod,"cwProductId",r)},checkCwMatchedProduct:function(){this.$refs.cwProductPredictive.checkPrice(this.prod,!0)},searchShipppingWeight:function(){var t="https://www.google.com.au/search?source=hp&ei=b54BXsjALoiW4-EPl8izwA4&q={term}&oq={term}&gs_l=psy-ab.3...9077.14394..15665...1.0..0.238.3323.0j15j3......0....2j1..gws-wiz.......33i21j33i10.9gohnIlLrZE&ved=0ahUKEwiItLOew83mAhUIyzgGHRfkDOgQ4dUDCAg&uact=5",e=this.prod.name+" "+"shipping weight".replace(" ","+");t=t.replace("{term}",e);var r=window.open(t,"_blank");r.focus()}}},ft=ht,vt=Object(u["a"])(ft,g,y,!1,null,null,null),bt=vt.exports,gt=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("b-table",{ref:"productTable",attrs:{responsive:"sm",items:t.items,fields:t.fields,small:!0,selectable:"","select-mode":"single"},on:{"row-clicked":t.productClicked,"row-dblclicked":t.productDoubleClicked},scopedSlots:t._u([{key:"cell(index)",fn:function(e){return[t._v(t._s(e.index+1))]}},{key:"cell(name)",fn:function(e){return[r("div",{staticClass:"prod-thumbnail-name"},[r("div",{staticClass:"thumbnail"},[e.item.thumbnail?r("img",{attrs:{src:e.item.thumbnail,width:"50px",height:"50px"}}):t._e()]),r("div",{staticClass:"name-2"},[r("text-highlight",{attrs:{queries:t.queries}},[t._v(t._s(e.value))]),r("br"),r("small",[t._v("PID: "+t._s(e.item.cwProductId))])],1)])]}},{key:"cell(weight)",fn:function(e){return[r("strong",[t._v(t._s(e.item.weight)+"(g)")]),t._v("\n    - "+t._s(t._f("currency")(e.item.shipPrice,t.audConfig))+"\n  ")]}},{key:"cell(tempPrices)",fn:function(e){return[r("div",{staticClass:"row"},[r("div",{staticClass:"col-md-3 col-sm-6 label"},[t._v("BV Price")]),r("div",{staticClass:"col-md-3 col-sm-6"},[t._v(t._s(t._f("currency")(e.item.bvPrice,t.audConfig)))]),r("div",{staticClass:"col-md-3 col-sm-6 label"},[t._v("CW Price")]),r("div",{staticClass:"col-md-3 col-sm-6"},[t._v(t._s(t._f("currency")(e.item.cwPrice,t.audConfig)))])]),r("div",{staticClass:"row"},[r("div",{staticClass:"col-md-3 col-sm-6 label"},[t._v("BV Sale Price")]),r("div",{staticClass:"col-md-3 col-sm-6"},[t._v(t._s(t._f("currency")(e.item.bvSalePrice,t.audConfig)))]),r("div",{staticClass:"col-md-3 col-sm-6 label"},[t._v("CW Sale Price")]),r("div",{staticClass:"col-md-3 col-sm-6"},[t._v(t._s(t._f("currency")(e.item.cwSalePrice,t.audConfig)))])])]}},{key:"cell(rndPrice)",fn:function(e){return[r("span",{staticClass:"price"},[t._v(t._s(t._f("currency")(e.item.rndPrice,t.vndConfig)))]),e.item.bvSalePricePick?r("b-badge",{attrs:{variant:"success"}},[t._v("BV Sale")]):t._e(),e.item.cwSalePricePick?r("b-badge",{attrs:{variant:"success"}},[t._v("CW Sale")]):t._e(),16500*e.item.sugPrice>e.item.rndPrice?r("b-badge",{attrs:{variant:"warning"}},[t._v("Recheck")]):t._e(),r("br"),r("small",[t._v("Sug. Price: "+t._s(t._f("currency")(e.item.sugPrice,t.audConfig))+" - "+t._s(t._f("currency")(16500*e.item.sugPrice,t.vndConfig)))])]}},{key:"cell(action)",fn:function(e){return[r("b-button",{staticClass:"mr-1",attrs:{type:"submit",size:"sm",variant:"success"},on:{click:function(r){return t.editProduct(e)}}},[r("i",{staticClass:"fa fa-edit"}),t._v(" Edit\n    ")]),r("b-button",{attrs:{type:"submit",size:"sm",variant:"danger"},on:{click:function(r){return t.deleteProduct(e)}}},[r("i",{staticClass:"fa fa-remove"}),t._v(" Delete\n    ")])]}}])})},yt=[],Ct=r("b50c"),_t={name:"ProductsListMobile",components:{TextHighlight:Ct["a"]},props:["products","searchText"],data:function(){return{fields:[{key:"index",label:"#"},{key:"name",class:"name"},{key:"weight",label:"Weight (g)",class:"weight"},{key:"tempPrices",label:"Temp. Prices",class:"temp-price"},{key:"rndPrice",label:"Price",class:"rnd-price"},{key:"action",label:"Action",class:"action"}]}},mounted:function(){},computed:{items:function(){return this.products||[]},queries:function(){return[this.searchText]}},methods:{productClicked:function(t){this.$emit("productClicked",t)},deleteProduct:function(t){this.$emit("deleteProduct",t)},editProduct:function(t){this.$emit("editProduct",t),this.$refs.productTable.selectRow(t.index)},productDoubleClicked:function(t,e){var r={item:t,index:e};this.editProduct(r)}}},kt=_t,Pt=(r("6b63"),Object(u["a"])(kt,gt,yt,!1,null,null,null)),wt=Pt.exports,xt=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("b-table",{ref:"productTable",attrs:{responsive:"sm",items:t.items,fields:t.fields,small:!0},on:{"row-clicked":t.productClicked,"row-dblclicked":t.productDoubleClicked},scopedSlots:t._u([{key:"cell(name)",fn:function(e){return[r("div",{staticClass:"row"},[r("div",{staticClass:"col-4",staticStyle:{overflow:"hidden"}},[r("img",{staticStyle:{"margin-left":"-30px"},attrs:{src:e.item.thumbnail,width:"150px",height:"150px"}})]),r("div",{staticClass:"col-8"},[r("strong",[r("text-highlight",{attrs:{queries:t.queries}},[t._v(t._s(e.item.name))])],1),r("br"),r("strong",[t._v("Weight:")]),t._v("\n        "+t._s(e.item.weight)+"(g)\n        - "+t._s(t._f("currency")(e.item.shipPrice,t.audConfig))+"\n        "),r("br"),r("strong",[t._v("CW Price")]),t._v("\n        : "+t._s(t._f("currency")(e.item.cwPrice,t.audConfig))+" -\n        "),r("strong",[t._v("Sale")]),t._v("\n        : "+t._s(t._f("currency")(e.item.cwSalePrice,t.audConfig))+"\n        "),r("br"),r("strong",{staticStyle:{width:"100px"}},[t._v("BV Price")]),t._v("\n        : "+t._s(t._f("currency")(e.item.bvPrice,t.audConfig))+" -\n        "),r("strong",[t._v("Sale")]),t._v("\n        : "+t._s(t._f("currency")(e.item.bvSalePrice,t.audConfig))+"\n        "),r("br"),r("span",{staticClass:"h4"},[r("strong",[t._v("Price")]),t._v("\n          : "+t._s(t._f("currency")(e.item.rndPrice,t.vndConfig))+"\n        ")]),e.item.bvSalePricePick?r("b-badge",{attrs:{variant:"success"}},[t._v("BV Sale")]):t._e(),e.item.cwSalePricePick?r("b-badge",{attrs:{variant:"success"}},[t._v("CW Sale")]):t._e(),r("div",{staticStyle:{"margin-top":"7px"}},[r("b-button",{staticClass:"mr-1",attrs:{type:"submit",size:"sm",variant:"success"},on:{click:function(r){return t.editProduct(e)}}},[r("i",{staticClass:"fa fa-edit"}),t._v(" Edit\n          ")]),r("b-button",{attrs:{type:"submit",size:"sm",variant:"danger"},on:{click:function(r){return t.deleteProduct(e)}}},[r("i",{staticClass:"fa fa-remove"}),t._v(" Delete\n          ")])],1)],1)])]}}])})},St=[],It={name:"ProductsList",components:{},props:[],extends:wt,data:function(){return{fields:[{key:"name",label:"",class:""}]}},mounted:function(){},computed:{},methods:{}},Ot=It,$t=(r("cdc0"),Object(u["a"])(Ot,xt,St,!1,null,null,null)),Tt=$t.exports,Dt={name:"Products",components:{productDetail:bt,productsList:wt,productsListMobile:Tt,viewPort:B},data:function(){return{products:[],product:{},productBatches:"",useMobileView:!1,searchText:"",pageSize:10,lastVisible:void 0,productCount:0,isLoadingMore:!1,saleProductCount:0,saleProducts:[]}},mounted:function(){var t=this,e=this;e.useMobileView=window.innerWidth<700,window.addEventListener("resize",(function(){e.useMobileView=window.innerWidth<700})),this.loadProducts(),this.$fb.counterService.getProductCount().then((function(e){return t.productCount=e}))},watch:{searchText:function(t,e){""!=e&&""==t&&(this.products=[],this.loadProducts())}},computed:{},methods:{loadProducts:function(t){var e=this;return this.$fb.productCollection.orderBy("name").startAfter(this.lastVisible||0).limit(this.pageSize).get().then((function(t){t.empty||(e.lastVisible=_.last(t.docs),t.forEach((function(t){e.products.push(t.data())})))}))},loadMoreProduct:function(t){var e=this;this.isLoadingMore=!0,this.searchText?this.searchProduct(this.lastVisible).then((function(){return e.isLoadingMore=!1})):this.loadProducts(this.lastVisible).then((function(){return e.isLoadingMore=!1}))},productClicked:function(t){this.product=Object(b["a"])({},t)},deleteProduct:function(t){var e=this,r=t.item,n=t.index;r&&this.$bvModal.msgBoxConfirm("Are you sure you want to delete [".concat(r.name,"]?")).then((function(t){t&&(e.$fb.productCollection.doc(r.id).delete().then((function(){e.products.splice(n,1)})),e.$fb.counterService.decreaseProduct().then((function(t){return e.productCount=t})))})).catch((function(t){console.log(t)}))},addNewProduct:function(){this.product=void 0,this.selectedIndex=void 0,this.$refs.productDetail.open(void 0)},productSaved:function(t){void 0!=this.selectedIndex?this.products.splice(this.selectedIndex,1,t):this.products.push(t)},editProduct:function(t){var e=t.index,r=t.item;this.product=Object(b["a"])({},r),this.selectedIndex=e,this.$refs.productDetail.open(this.product)},saveProductBatches:function(){var t=this,e=JSON.parse(this.productBatches);e.forEach((function(t){t.nameSearch=T(t.name)})),console.table(e);var r=this.$fb.db.batch();e.forEach((function(e){var n=t.$fb.productCollection.doc();e.id=n.id,r.set(n,e)})),r.commit().then((function(){console.log("Finish Product Batches")}))},clickSearchProduct:function(){this.products=[],this.searchProduct()},searchProduct:function(t){var e=this;if(this.searchText)return this.$fb.productCollection.where("nameSearch","array-contains",this.searchText.toLowerCase().trim()).orderBy("name").startAfter(t||0).limit(10).get().then((function(t){t.empty||(e.lastVisible=_.last(t.docs),t.forEach((function(t){e.products.push(t.data())})))}))},seartTextKeydown:function(t){13===t.keyCode&&(this.products=[],this.searchProduct())},clearSearchText:function(){this.searchText=""},checkCwPrice:function(){},clearAllSalePrices:function(){var t=this;this.$fb.productCollection.where("cwSalePricePick","==",!0).get().then((function(e){e.empty||(t.saleProductCount=e.docs.length,t.saleProductCount>0&&(e.docs.forEach((function(e){return t.saleProducts.push(e.data())})),t.$bvModal.msgBoxConfirm("Are you sure you want to remove sale price for [".concat(t.saleProductCount,"] products?")).then((function(e){e&&t.saleProducts.forEach((function(e){e.cwSalePricePick=!1,t.$fb.productCollection.doc(e.id).set(e)}))})).catch((function(t){console.log(t)}))))}))}}},Et=Dt,Mt=(r("b12d"),Object(u["a"])(Et,f,v,!1,null,null,null)),Ft=Mt.exports,Lt=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"animated fadeIn"},[r("b-row",[r("b-col",[r("b-card",[r("div",{attrs:{slot:"header"},slot:"header"},[r("span",[r("i",{staticClass:"fa fa-user-o"}),t._v("\n            Customers ("+t._s(t.count)+")\n          ")]),r("b-link",{staticClass:"pull-right",on:{click:t.addNewCustomer}},[t._v("Add New Customer")])],1),r("b-row",[r("b-col",{attrs:{sm:"12",md:"6"}},[r("b-input-group",{staticClass:"mb-5"},[r("b-form-input",{on:{keydown:function(e){return t.seartTextKeydown(e)}},model:{value:t.searchText,callback:function(e){t.searchText=e},expression:"searchText"}}),r("b-input-group-append",[""!=t.searchText?r("span",{staticClass:"fa fa-close",attrs:{id:"searchclear"},on:{click:t.clearSearchText}}):t._e(),r("b-button",{attrs:{variant:"outline-success"},on:{click:function(e){return t.searchCustomer()}}},[r("span",{staticClass:"fa fa-search"}),t._v(" Search\n                ")])],1)],1)],1)],1),r("view-port",{scopedSlots:t._u([{key:"desktop",fn:function(){return[r("b-table",{ref:"customerTable",attrs:{responsive:"sm",items:t.customers,fields:t.fields,small:!0,selectable:"","select-mode":"single"},on:{"row-clicked":t.customerClicked,"row-dblclicked":t.customerDoubleClicked},scopedSlots:t._u([{key:"cell(index)",fn:function(e){return[t._v(t._s(e.index+1))]}},{key:"cell(name)",fn:function(e){return[e.item.isEditing?[r("b-form-input",{attrs:{type:"text",placeholder:"Enter customer name"},model:{value:e.item.name,callback:function(r){t.$set(e.item,"name",r)},expression:"data.item.name"}})]:t._e(),e.item.isEditing?t._e():[t._v(t._s(e.value))]]}},{key:"cell(address)",fn:function(e){return[e.item.isEditing?[r("b-form-input",{attrs:{type:"text",placeholder:"Enter customer address"},model:{value:e.item.address,callback:function(r){t.$set(e.item,"address",r)},expression:"data.item.address"}})]:t._e(),e.item.isEditing?t._e():[t._v(t._s(e.value))]]}},{key:"cell(phone)",fn:function(e){return[e.item.isEditing?[r("b-form-input",{attrs:{type:"text",placeholder:"Enter customer phone"},model:{value:e.item.phone,callback:function(r){t.$set(e.item,"phone",r)},expression:"data.item.phone"}})]:t._e(),e.item.isEditing?t._e():[t._v(t._s(e.value))]]}},{key:"cell(action)",fn:function(e){return[e.item.isEditing?t._e():[r("b-button",{staticClass:"mr-1",attrs:{type:"submit",size:"sm",variant:"info"},on:{click:function(r){return t.viewOrders(e)}}},[r("i",{staticClass:"fa fa-list"}),t._v(" Orders\n                  ")]),r("b-button",{staticClass:"mr-1",attrs:{type:"submit",size:"sm",variant:"success"},on:{click:function(r){return t.editCustomer(e)}}},[r("i",{staticClass:"fa fa-edit"}),t._v(" Edit\n                  ")]),r("b-button",{attrs:{type:"submit",size:"sm",variant:"danger"},on:{click:function(r){return t.deleteCustomer(e)}}},[r("i",{staticClass:"fa fa-remove"}),t._v(" Delete\n                  ")])],e.item.isEditing?[r("b-button",{staticClass:"mr-1",attrs:{type:"submit",size:"sm",variant:"success"},on:{click:function(r){return t.saveCustomer(e)}}},[r("i",{staticClass:"fa fa-edit"}),t._v(" Save\n                  ")]),r("b-button",{attrs:{type:"submit",size:"sm",variant:"danger"},on:{click:function(r){return t.cancelEditCustomer(e)}}},[r("i",{staticClass:"fa fa-remove"}),t._v(" Cancel\n                  ")])]:t._e()]}}])})]},proxy:!0},{key:"mobile",fn:function(){return[r("div",[r("b-table",{ref:"customerTable",attrs:{responsive:"sm",items:t.customers,fields:t.mobileFields,small:!0,selectable:"","select-mode":"single"},on:{"row-clicked":t.customerClicked,"row-dblclicked":t.customerDoubleClicked},scopedSlots:t._u([{key:"cell(index)",fn:function(e){return[t._v(t._s(e.index+1))]}},{key:"cell(name)",fn:function(e){return[r("b-row",[r("b-col",[e.item.isEditing?[r("b-form-group",{attrs:{"label-size":"sm",label:"Name"}},[r("b-form-input",{attrs:{size:"sm",type:"text",placeholder:"Enter customer name"},model:{value:e.item.name,callback:function(r){t.$set(e.item,"name",r)},expression:"data.item.name"}})],1)]:t._e(),e.item.isEditing?t._e():[r("strong",[t._v(t._s(e.value))])]],2)],1),r("b-row",[r("b-col",[e.item.isEditing?[r("b-form-group",{attrs:{"label-size":"sm",label:"Address"}},[r("b-form-input",{attrs:{size:"sm",type:"text",placeholder:"Enter customer address"},model:{value:e.item.address,callback:function(r){t.$set(e.item,"address",r)},expression:"data.item.address"}})],1)]:t._e(),e.item.isEditing?t._e():[t._v("Address: "+t._s(e.item.address))]],2)],1),r("b-row",[r("b-col",[e.item.isEditing?[r("b-form-group",{attrs:{"label-size":"sm",label:"Phone"}},[r("b-form-input",{attrs:{size:"sm",type:"text",placeholder:"Enter customer phone"},model:{value:e.item.phone,callback:function(r){t.$set(e.item,"phone",r)},expression:"data.item.phone"}})],1)]:t._e(),e.item.isEditing?t._e():[t._v("Phone: "+t._s(e.item.phone))]],2)],1),r("b-row",{staticClass:"mt-2 mb-2"},[r("b-col",[e.item.isEditing?t._e():[r("b-button",{staticClass:"mr-1",attrs:{type:"submit",size:"sm",variant:"success"},on:{click:function(r){return t.editCustomer(e)}}},[r("i",{staticClass:"fa fa-edit"}),t._v(" Edit\n                        ")]),r("b-button",{attrs:{type:"submit",size:"sm",variant:"danger"},on:{click:function(r){return t.deleteCustomer(e)}}},[r("i",{staticClass:"fa fa-remove"}),t._v(" Delete\n                        ")])],e.item.isEditing?[r("b-button",{staticClass:"mr-1",attrs:{type:"submit",size:"sm",variant:"success"},on:{click:function(r){return t.saveCustomer(e)}}},[r("i",{staticClass:"fa fa-edit"}),t._v(" Save\n                        ")]),r("b-button",{attrs:{type:"submit",size:"sm",variant:"danger"},on:{click:function(r){return t.cancelEditCustomer(e)}}},[r("i",{staticClass:"fa fa-remove"}),t._v(" Cancel\n                        ")])]:t._e()],2)],1)]}}])})],1)]},proxy:!0}])}),r("b-row",{staticClass:"load-more"},[r("b-button",{attrs:{variant:"outline-success"},on:{click:t.loadMore}},[t._v("Load more")])],1)],1)],1)],1)],1)},Rt=[],At={name:"Customers",components:{viewPort:B},data:function(){return{customers:[],customer:{},searchText:"",fields:[{key:"index",label:"#",class:"customer-index-col"},{key:"name",class:"customer-name-col"},{key:"address",class:"customer-address-col"},{key:"phone",class:"customer-phone-col"},{key:"action",class:"customer-action-col"}],mobileFields:[{key:"index",label:"#"},{key:"name",label:"Details"}],paging:{total:0,page:1,size:10},lastVisible:void 0,count:0}},mounted:function(){var t=this;this.loadCustomers(),this.$fb.counterService.getCustomerCount().then((function(e){return t.count=e}))},watch:{searchText:function(t,e){""!=e&&""==t&&(this.customers=[],this.lastVisible=void 0,this.loadCustomers())}},computed:{},methods:{loadCustomers:function(t){var e=this,r=this.$fb.customerCollection.orderBy("name").limit(this.paging.size);this.lastVisible&&(r=r.startAfter(this.lastVisible)),r.get().then((function(t){t.empty||(e.lastVisible=t.docs[t.docs.length-1],t.forEach((function(t){var r=t.data();r.id=t.id,e.customers.push(r)})))}))},customerClicked:function(t){this.customer=Object(b["a"])({},t)},correctData:function(){},deleteCustomer:function(t){var e=this,r=t.item,n=t.index;this.$bvModal.msgBoxConfirm("Are you sure you want to delete customer: [".concat(r.name,"]?")).then((function(t){t&&e.$fb.customerCollection.doc(r.id).delete().then((function(){e.customers.splice(n,1),e.$fb.counterService.decreaseCustomer().then((function(t){return e.count=t}))}))})).catch((function(t){console.log(t)}))},loadMore:function(){this.loadCustomers()},seartTextKeydown:function(t){13===t.keyCode&&this.searchCustomer()},clearSearchText:function(){this.searchText=""},searchCustomer:function(t){var e=this;if(this.searchText)this.$fb.customerCollection.where("nameSearch","array-contains",this.searchText.toLowerCase().trim()).orderBy("name").startAfter(t||0).limit(10).get().then((function(t){e.customers=[],t.empty||(e.lastVisible=_.last(t.docs),t.forEach((function(t){var r=t.data();r.id=t.id,e.customers.push(r)})))}))},editCustomer:function(t){var e=t.item,r=t.index;e.backup=Object(b["a"])({},e),e.isEditing=!0,this.customers.splice(r,1,e)},saveCustomer:function(t){var e=this,r=t.item,n=t.index;if(r.name)return delete r.backup,delete r.isEditing,this.submitCustomer(r).then((function(t){e.customers.splice(n,1,t)}))},submitCustomer:function(t){var e=this;if(t.nameSearch=T(t.name),t.version=(t.version||0)+1,t.id)return this.$fb.customerCollection.doc(t.id).set(t).then((function(){return t}));var r=this.$fb.customerCollection.doc();return t.id=r.id,r.set(t).then((function(){return e.increaseCustomerCount(),t}))},increaseCustomerCount:function(){var t=this;this.$fb.counterService.increaseCustomer().then((function(e){return t.count=e}))},cancelEditCustomer:function(t){var e=t.item,r=t.index;e.id?this.customers.splice(r,1,e.backup):this.customers.splice(r,1)},addNewCustomer:function(){var t={name:"",address:"",phone:"",isEditing:!0};this.customers.unshift(t)},customerDoubleClicked:function(t,e,r){this.editCustomer({index:e,item:t})},viewOrders:function(t){t.index;var e=t.item;this.$router.push({name:"CustomerOrders",params:{id:e.id}})}}},Bt=At,jt=Object(u["a"])(Bt,Lt,Rt,!1,null,null,null),Nt=jt.exports,qt=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"animated fadeIn"},[r("b-row",[r("b-col",[r("b-card",[r("div",{attrs:{slot:"header"},slot:"header"},[r("b-link",{on:{click:t.goToCustomers}},[r("i",{staticClass:"fa fa-user-o"}),t._v(" Customers:\n          ")]),r("strong",[t._v(t._s(t.customer.name))]),t._v("'s Orders\n          "),r("b-link",{staticClass:"pull-right",on:{click:t.recalculateOrders}},[t._v("Recalculate Orders")])],1)])],1)],1),r("router-view")],1)},Qt=[],Vt=(r("96cf"),r("3b8d")),zt={name:"Orders",components:{},data:function(){return{customer:{}}},mounted:function(){this.loadCustomer()},computed:{},methods:{loadCustomer:function(){var t=this,e=this.$route.params.id;this.$fb.customerCollection.doc(e).get().then((function(e){return t.customer=e.data()}))},goToCustomers:function(){this.$router.push({name:"Customers"})},recalculateOrders:function(){var t=Object(Vt["a"])(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.loadOrders();case 2:e=t.sent,console.log(e);case 4:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),loadOrders:function(){var t=Object(Vt["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.abrupt("return",this.$fb.orderCollection.orderBy("dateCreated").get().then((function(t){return t.empty?[]:t.docs.map((function(t){return t.data()}))})));case 1:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()}},Wt=zt,Ut=Object(u["a"])(Wt,qt,Qt,!1,null,null,null),Ht=Ut.exports,Yt=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"animated fadeIn"},[r("b-row",[r("b-col",[r("b-card",[r("div",{attrs:{slot:"header"},slot:"header"},[r("i",{staticClass:"cui-user icons font-lg"}),t._v(" Orders\n          "),r("b-link",{staticClass:"pull-right",on:{click:t.addNewOrder}},[t._v("Add New Order")])],1),r("b-table",{attrs:{responsive:"sm",items:t.orders,fields:t.fields,small:!0,selectable:"","select-mode":"single",busy:t.isLoadingData},on:{"row-clicked":t.orderClicked},scopedSlots:t._u([{key:"cell(name)",fn:function(e){return[r("a",{staticStyle:{"font-size":"15px"},attrs:{href:t.buildRoute(e.item),variant:"link"}},[t._v(t._s(e.item.name))])]}},{key:"cell(dateCreated)",fn:function(e){return[t._v(t._s(t._f("date")(e.item.dateCreated.toDate())))]}},{key:"cell(quantity)",fn:function(e){return[t._v(t._s(t.sumQuantity(e.item)))]}},{key:"cell(total)",fn:function(e){return[t._v(t._s(t._f("currency")(t.sumTotal(e.item),t.vndConfig)))]}},{key:"cell(action)",fn:function(e){return[0==t.sumQuantity(e.item)?r("b-button",{attrs:{type:"submit",size:"sm",variant:"danger"},on:{click:function(r){return t.deleteOrder(e.item)}}},[r("i",{staticClass:"fa fa-remove"}),t._v(" Delete\n            ")]):t._e()]}}])})],1)],1)],1),r("router-view")],1)},Kt=[],Jt=(r("20d6"),r("aef6"),{name:"Orders",components:{},data:function(){return{orders:[],counter:{},selectedOrder:{},isLoadingData:!1,fields:[{key:"name"},{key:"dateCreated",label:"Created Date"},{key:"quantity",label:"Quantity"},{key:"total",label:"Total"},{key:"action",class:"text-right"}]}},mounted:function(){this.loadOrders(),this.loadCounter()},computed:{},methods:{loadCounter:function(){var t=this;this.$fb.counterCollection.limit(1).onSnapshot((function(e){e.empty||e.forEach((function(e){t.counter=e.data(),t.counter.id=e.id}))}))},loadOrders:function(){var t=this;this.orders=[],this.isLoadingData=!0,this.$fb.orderCollection.orderBy("dateCreated","desc").limit(10).get().then((function(e){e.empty||e.forEach((function(e){return t.orders.push(e.data())}))})).then((function(){return t.isLoadingData=!1}))},addNewOrder:function(){var t=this,e={name:this.buildOrderName(),dateCreated:new Date,status:"OPEN"},r=this.$fb.orderCollection.doc();e.id=r.id,r.set(e).then((function(){t.$fb.orderCollection.doc(e.id).get().then((function(e){return t.orders.unshift(e.data())})),t.increaseOrderCount(1)}))},buildOrderName:function(){var t=(this.counter.orderCount||0)+1;return(t+"").endsWith("1")?t+"st Order":(t+"").endsWith("2")?t+"nd Order":(t+"").endsWith("3")?t+"rd Order":t+"th Order"},orderClicked:function(t){this.selectedOrder=t,this.$router.push({name:"OrderStatistic",params:{id:t.id}})},deleteOrder:function(t){var e=this;this.$fb.orderCollection.doc(t.id).delete().then((function(){var r=e.orders.findIndex((function(e){return e.id==t.id}));r>-1&&e.orders.splice(r,1),e.increaseOrderCount(-1)}))},increaseOrderCount:function(t){this.counter.orderCount=this.counter.orderCount+t,this.$fb.counterCollection.doc(this.counter.id).set(this.counter)},sumQuantity:function(t){return t.items&&0!=t.items.length?t.items.reduce((function(t,e){return t+e.quantity}),0):0},sumTotal:function(t){return t.items&&0!=t.items.length?t.items.reduce((function(t,e){return t+e.quantity*parseFloat(e.rndPrice||e.product.rndPrice)}),0):0},buildRoute:function(t){var e=location;e.origin;return this.$router.resolve({name:"OrderDetail",params:{id:t.id}}).href}}}),Gt=Jt,Xt=Object(u["a"])(Gt,Yt,Kt,!1,null,null,null),Zt=Xt.exports,te=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"animated fadeIn"},[r("b-row",[r("b-col",[r("b-card",[r("div",{attrs:{slot:"header"},slot:"header"},[r("b-link",{on:{click:t.goToOrderList}},[r("i",{staticClass:"fa fa-server"}),t._v(" Order:\n          ")]),r("strong",[t._v(t._s(t.order.name))]),r("div",{staticClass:"pull-right"},[r("b-link",{staticClass:"mr-1",on:{click:t.goToShipmentPage}},[t._v("Shipment Page |")]),r("b-link",{staticClass:"mr-1",on:{click:t.goToCollectionPage}},[t._v("Collection Page |")]),r("b-link",{on:{click:t.addNewOrderItem}},[t._v("Add New Item")])],1)],1),r("view-port",{scopedSlots:t._u([{key:"desktop",fn:function(){return[r("div",{staticClass:"order-item"},[r("b-table",{attrs:{"foot-clone":"",responsive:"sm",items:t.order.items,fields:t.fields,small:!0,selectable:"","select-mode":"single"},on:{"row-clicked":t.orderItemClicked},scopedSlots:t._u([{key:"cell(index)",fn:function(e){return[t._v(t._s(e.index+1))]}},{key:"cell(product.name)",fn:function(e){return[r("a",{attrs:{href:"javascript:void(0)"},on:{click:function(r){return t.showProductDetailModal(e.item)}}},[t._v("\n                    "+t._s(e.value)+"\n                    "),e.item.product.buyPrice&&0!=e.item.product.buyPrice?t._e():r("small",[r("i",{staticStyle:{color:"red"}},[t._v("missing buy price")])])]),e.item.product.bvSalePricePick?r("b-badge",{attrs:{variant:"success"}},[t._v("BV Sale")]):t._e(),e.item.product.cwSalePricePick?r("b-badge",{attrs:{variant:"success"}},[t._v("CW Sale")]):t._e(),t._v(" \n                  "),e.item.product.cwProductId?r("b-link",{attrs:{href:t.appSettings.cwBuyProductUrl.replace("{id}",e.item.product.cwProductId),target:"_blank"}},[t._v("[Buy CW]")]):t._e()]}},{key:"cell(price)",fn:function(e){return[e.item.rndPrice!=e.item.product.rndPrice?r("del",{staticStyle:{color:"darkgrey"}},[t._v(t._s(t._f("currency")(e.item.product.rndPrice,t.vndConfig)))]):t._e(),t._v("\n                  "+t._s(t._f("currency")(e.item.rndPrice,t.vndConfig))+"\n                ")]}},{key:"cell(total)",fn:function(e){return[t._v(t._s(t._f("currency")(t.calculateTotalOrderItem(e.item),t.vndConfig)))]}},{key:"cell(collectedQuantity)",fn:function(e){return[r("number-input",{attrs:{min:0,max:e.item.quantity,inline:"",controls:"",center:"",size:"sm"},on:{change:function(r){return t.collectedQuantityChanged(e.item,r)}},model:{value:e.item.collectedQuantity,callback:function(r){t.$set(e.item,"collectedQuantity",r)},expression:"data.item.collectedQuantity"}})]}},{key:"cell(collected)",fn:function(e){return[r("b-form-checkbox",{on:{change:function(r){return t.collectedChanged(r,e.item)}},model:{value:e.item.collected,callback:function(r){t.$set(e.item,"collected",r)},expression:"data.item.collected"}})]}},{key:"cell(action)",fn:function(e){return[r("b-button",{staticClass:"mr-1",attrs:{type:"submit",size:"sm",variant:"success"},on:{click:function(r){return t.editOrderItem(e.item)}}},[r("i",{staticClass:"fa fa-edit"}),t._v(" Edit\n                  ")]),r("b-button",{attrs:{type:"submit",size:"sm",variant:"danger"},on:{click:function(r){return t.deleteOrderItem(e.item)}}},[r("i",{staticClass:"fa fa-remove"}),t._v(" Delete\n                  ")])]}},{key:"foot()",fn:function(t){}},{key:"foot(quantity)",fn:function(e){return[t._v(t._s(t.sumQuantity))]}},{key:"foot(total)",fn:function(e){return[t._v(t._s(t._f("currency")(t.sumTotal,t.vndConfig)))]}},{key:"foot(collectedQuantity)",fn:function(e){return[t._v(t._s(t.sumCollectedQuantity))]}}])})],1)]},proxy:!0},{key:"mobile",fn:function(){return[r("b-table",{attrs:{"foot-clone":"",responsive:"sm",items:t.order.items,fields:t.mobileFields,small:!0,selectable:"","select-mode":"single"},on:{"row-clicked":t.orderItemClicked},scopedSlots:t._u([{key:"cell(index)",fn:function(e){return[r("div",[r("strong",[t._v("\n                    "+t._s(e.index+1)+".\n                    "+t._s(e.item.customer.name)+"\n                  ")])]),r("div",[r("a",{attrs:{href:"javascript:void(0)"},on:{click:function(r){return t.showProductDetailModal(e.item)}}},[t._v("\n                    "+t._s(e.item.product.name)+"\n                    "),e.item.product.buyPrice&&0!=e.item.product.buyPrice?t._e():r("small",[r("i",{staticStyle:{color:"red"}},[t._v("missing buy price")])])]),e.item.product.bvSalePricePick?r("b-badge",{attrs:{variant:"success"}},[t._v("BV Sale")]):t._e(),e.item.product.cwSalePricePick?r("b-badge",{attrs:{variant:"success"}},[t._v("CW Sale")]):t._e(),t._v(" \n                  "),e.item.product.cwProductId?r("b-link",{attrs:{href:t.appSettings.cwBuyProductUrl.replace("{id}",e.item.product.cwProductId),target:"_blank"}},[t._v("[Buy CW]")]):t._e()],1),r("div",{staticClass:"row"},[r("div",{staticClass:"col-6"},[r("small",[e.item.rndPrice!=e.item.product.rndPrice?r("del",{staticStyle:{color:"darkgrey"}},[t._v(t._s(t._f("currency")(e.item.product.rndPrice,t.vndConfig)))]):t._e()]),t._v("\n                    "+t._s(t._f("currency")(e.item.rndPrice,t.vndConfig))+"\n                  ")]),r("div",{staticClass:"col-2"},[t._v(t._s(e.item.quantity))]),r("div",{staticClass:"col-4"},[t._v(t._s(t._f("currency")(t.calculateTotalOrderItem(e.item),t.vndConfig)))])]),r("div",{staticClass:"row",staticStyle:{"margin-top":"10px"}},[r("div",{staticClass:"col-6"},[r("div",{staticClass:"order-detail-mobile-collected-qty"},[r("number-input",{attrs:{min:0,max:e.item.quantity,inline:"",controls:"",center:"",size:"sm"},on:{change:function(r){return t.collectedQuantityChanged(e.item,r)}},model:{value:e.item.collectedQuantity,callback:function(r){t.$set(e.item,"collectedQuantity",r)},expression:"data.item.collectedQuantity"}})],1),r("div",{staticClass:"order-detail-mobile-collected-all"},[r("b-form-checkbox",{on:{change:function(r){return t.collectedChanged(r,e.item)}},model:{value:e.item.collected,callback:function(r){t.$set(e.item,"collected",r)},expression:"data.item.collected"}})],1)]),r("div",{staticClass:"col-6 pull-right"},[r("b-button",{staticClass:"mr-1",attrs:{type:"submit",size:"sm",variant:"success"},on:{click:function(r){return t.editOrderItem(e.item)}}},[r("i",{staticClass:"fa fa-edit"}),t._v(" Edit\n                    ")]),r("b-button",{attrs:{type:"submit",size:"sm",variant:"danger"},on:{click:function(r){return t.deleteOrderItem(e.item)}}},[r("i",{staticClass:"fa fa-remove"}),t._v(" Delete\n                    ")])],1)])]}},{key:"foot()",fn:function(e){return[r("hr"),r("b-row",[r("b-col",[t._v("Quantity")]),r("b-col",{staticClass:"text-right"},[t._v(t._s(t.sumQuantity))])],1),r("b-row",[r("b-col",[t._v("Total")]),r("b-col",{staticClass:"text-right"},[t._v(t._s(t._f("currency")(t.sumTotal,t.vndConfig)))])],1),r("b-row",[r("b-col",[t._v("Collected Qty")]),r("b-col",{staticClass:"text-right"},[t._v(t._s(t.sumCollectedQuantity))])],1)]}}])})]},proxy:!0}])})],1)],1)],1),r("product-detail",{ref:"productDetail"}),r("order-detail-edit-item",{ref:"editItemModal",attrs:{id:"editItem",item:t.selectedOrderItem},on:{saveOrderItem:t.saveOrderItem}})],1)},ee=[],re=r("2ef0"),ne=r.n(re),ie=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",t._g({staticClass:"input-group",class:{"input-group-sm":"sm"==t.size,"input-group-lg":"lg"==t.size}},t.listeners),[r("div",{staticClass:"input-group-prepend"},[t.controls?r("button",{staticClass:"btn btn-outline-secondary",attrs:{type:"button",disabled:t.disabled||t.readonly||!t.decreasable},on:{click:t.decrease}},[r("i",{staticClass:"fa fa-minus"})]):t._e()]),r("input",t._b({ref:"input",staticClass:"form-control",class:{"text-center":t.center},attrs:{type:"text",name:t.name,min:t.min,max:t.max,step:t.step,readonly:t.readonly||!t.inputtable,disabled:t.disabled||!t.decreasable&&!t.increasable,placeholder:t.placeholder,autocomplete:"off"},domProps:{value:t.currentValue},on:{change:t.change,paste:t.paste}},"input",t.attrs,!1)),r("div",{staticClass:"input-group-append"},[t.controls?r("button",{staticClass:"btn btn-outline-secondary",attrs:{type:"button",disabled:t.disabled||t.readonly||!t.increasable},on:{click:t.increase}},[r("i",{staticClass:"fa fa-plus"})]):t._e()])])},se=[],oe=(r("ee1d"),Number.isNaN||window.isNaN),ae=/^-?(?:\d+|\d+\.\d+|\.\d+)(?:[eE][-+]?\d+)?$/,ce=/\.\d*(?:0|9){10}\d*$/,ue=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e11;return ce.test(t)?Math.round(t*e)/e:t},le={name:"NumberInput",model:{event:"change"},props:{attrs:{type:Object,default:void 0},center:Boolean,controls:Boolean,disabled:Boolean,inputtable:{type:Boolean,default:!0},inline:Boolean,max:{type:Number,default:1/0},min:{type:Number,default:-1/0},name:{type:String,default:void 0},placeholder:{type:String,default:void 0},readonly:Boolean,rounded:Boolean,size:{type:String,default:void 0},step:{type:Number,default:1},value:{type:Number,default:NaN}},data:function(){return{currentValue:NaN}},mouted:function(){},computed:{increasable:function(){var t=this.currentValue;return oe(t)||t<this.max},decreasable:function(){var t=this.currentValue;return oe(t)||t>this.min},listeners:function(){var t=Object(b["a"])({},this.$listeners);return delete t.change,t}},watch:{value:{immediate:!0,handler:function(t,e){oe(t)&&"undefined"===typeof e||t===this.currentValue||this.setValue(t)}}},methods:{change:function(t){this.setValue(Math.min(this.max,Math.max(this.min,t.target.value)))},paste:function(t){var e=t.clipboardData||window.clipboardData;e&&!ae.test(e.getData("text"))&&t.preventDefault()},decrease:function(){if(this.decreasable){var t=this.currentValue;oe(t)&&(t=0),this.setValue(Math.min(this.max,Math.max(this.min,ue(t-this.step))))}},increase:function(){if(this.increasable){var t=this.currentValue;oe(t)&&(t=0),this.setValue(Math.min(this.max,Math.max(this.min,ue(t+this.step))))}},setValue:function(t){var e=this.currentValue,r=this.rounded?Math.round(t):t;this.min<=this.max&&(r=Math.min(this.max,Math.max(this.min,r))),this.currentValue=r,r===e&&(this.$refs.input.value=r),this.$emit("change",r,e)}}},de=le,me=(r("bebb"),Object(u["a"])(de,ie,se,!1,null,"dbc7af6c",null)),pe=me.exports,he=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("b-modal",{attrs:{id:t.modalId,title:t.modalTitle,size:"lg"},on:{ok:t.saveOrderItem}},[r("b-row",[r("b-col",{attrs:{sm:"4"}},[r("b-form-group",[r("label",[t._v("Customer")]),r("vue-suggestion",{attrs:{items:t.sugCustomers,"item-template":t.customerSugTemplate,setLabel:t.setLabel},on:{focus:t.sugCustomersFocused,onInputChange:t.sugCustomersInputChanged,scrollEnd:t.loadMoreSugCustomers},model:{value:t.orderItem.customer,callback:function(e){t.$set(t.orderItem,"customer",e)},expression:"orderItem.customer"}})],1)],1),r("b-col",{attrs:{sm:"8"}},[r("b-form-group",[r("label",[t._v("Product")]),r("vue-suggestion",{attrs:{items:t.sugProducts,"item-template":t.productSugTemplate,setLabel:t.setLabel},on:{focus:t.sugProductsFocused,onInputChange:t.sugProductsInputChanged,onItemSelected:t.sugProductsItemSelected,scrollEnd:t.loadMoreSugProducts},model:{value:t.orderItem.product,callback:function(e){t.$set(t.orderItem,"product",e)},expression:"orderItem.product"}})],1)],1)],1),r("b-row",[r("b-col",{attrs:{sm:"4"}},[r("b-form-group",[r("label",[t._v("Quantity")]),r("number-input",{attrs:{min:1,max:999,inline:"",controls:"",center:""},model:{value:t.orderItem.quantity,callback:function(e){t.$set(t.orderItem,"quantity",e)},expression:"orderItem.quantity"}})],1)],1),r("b-col",{attrs:{sm:"8"}},[r("b-form-group",[r("label",[t._v("Price - "+t._s(t._f("currency")(t.orderItem.rndPrice,t.vndConfig)))]),r("b-form-input",{attrs:{type:"text",placeholder:"Enter rnd price"},model:{value:t.orderItem.rndPrice,callback:function(e){t.$set(t.orderItem,"rndPrice",e)},expression:"orderItem.rndPrice"}})],1)],1)],1)],1)},fe=[],ve=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"vue-suggestion",class:t.wrapperClasses},[r("div",{staticClass:"vue-suggestion-input-group",class:[{"vue-suggestion-selected":t.value},t.inputWrapperClasses]},[r("input",{directives:[{name:"model",rawName:"v-model",value:t.searchText,expression:"searchText"}],ref:"searchText",staticClass:"vue-suggestion-input",class:t.inputClasses,attrs:{placeholder:t.placeholder,disabled:t.disabled,type:"search"},domProps:{value:t.searchText},on:{blur:t.blur,focus:t.focus,input:[function(e){e.target.composing||(t.searchText=e.target.value)},t.inputChange],keydown:[function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:(e.preventDefault(),t.keyEnter(e))},function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"up",38,e.key,["Up","ArrowUp"])?null:(e.preventDefault(),t.keyUp(e))},function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"down",40,e.key,["Down","ArrowDown"])?null:(e.preventDefault(),t.keyDown(e))}]}}),t._t("searchSlot")],2),t.loading?t._t("loading",[t._v("Loading...")]):t.showList?t._t("suggestionList",[r("div",{ref:"vueSuggestionList",staticClass:"vue-suggestion-list"},[t._l(t.items,(function(e,n){return r("div",{key:e.id,staticClass:"vue-suggestion-list-item",class:[{"vue-suggestion-item-active":n===t.cursor},t.suggestionItemWrapperClasses],on:{click:function(r){return t.selectItem(e)},mouseover:function(e){t.cursor=n}}},[r(t.itemTemplate,{tag:"div",class:t.suggestionItemClasses,attrs:{item:e}})],1)})),r("div",{staticClass:"vue-suggestion-list-item load-more-item",staticStyle:{"text-align":"center"}},[r("button",{staticClass:"btn btn-outline-success btn-sm",on:{click:t.loadMore}},[t._v("Load more")])])],2)]):t._e()],2)},be=[],ge=r("1157"),ye=r.n(ge),Ce={name:"VueSuggestion",props:{itemTemplate:{type:Object,required:!0},minLen:{type:Number,default:1},value:{type:[Object,String,Number],default:null},setLabel:{type:Function,default:function(t){return t}},items:{type:Array,default:function(){return[]}},disabled:{type:Boolean,default:!1},loading:{type:Boolean,default:!1},placeholder:{type:String,default:""},inputClasses:{type:String,default:""},wrapperClasses:{type:String,default:""},inputWrapperClasses:{type:String,default:""},suggestionListClasses:{type:String,default:""},suggestionGroupClasses:{type:String,default:""},suggestionGroupHeaderClasses:{type:String,default:""},suggestionItemWrapperClasses:{type:String,default:""},suggestionItemClasses:{type:String,default:""}},data:function(){return{searchText:"",showList:!1,cursor:0}},computed:{itemGroups:function(){return this.items.reduce((function(t,e){var r=t.find((function(t){return t.header===e.suggestionGroup}));return r?r.items.push(e):t.push({header:e.suggestionGroup||"",items:[e]}),t}),[])}},watch:{value:{handler:function(t){t&&(this.searchText=this.setLabel(t))},deep:!0},"items.length":function(){this.showList=this.isAbleToShowList();var t=this;ye()(this.$refs.vueSuggestionList).on("scroll",(function(){ye()(this).scrollTop()+ye()(this).innerHeight()>=ye()(this)[0].scrollHeight&&t.$emit("scrollEnd",t.items.length)}))}},created:function(){this.checkMissingProps()},mounted:function(){this.value&&(this.searchText=this.setLabel(this.value))},methods:{inputChange:function(){var t=this;this.showList=this.isAbleToShowList(),this.cursor=0,it&&window.clearTimeout(it),it=window.setTimeout((function(){t.$emit("onInputChange",t.searchText)}),500)},isAbleToShowList:function(){return!0},checkMissingProps:function(){this.itemTemplate||console.warn("You need to pass `template` as the suggestion list item template")},focus:function(){this.$emit("focus",this.searchText),this.showList=this.isAbleToShowList()},blur:function(){var t=this;this.$emit("blur",this.searchText),nt=setTimeout((function(){t.showList=!1}),200)},loadMore:function(){nt&&window.clearTimeout(nt),ye()(this.$refs.searchText).focus(),this.$emit("scrollEnd",this.items.length)},selectItem:function(t){t&&(this.searchText=this.setLabel(t),this.$emit("onItemSelected",t)),this.$emit("input",t)},keyUp:function(){this.$emit("keyUp",this.searchText),this.cursor>0&&(this.cursor-=1)},keyDown:function(){this.$emit("keyDown",this.searchText),this.cursor<this.items.length-1?this.cursor+=1:this.$emit("scrollEnd",this.items.length)},keyEnter:function(){this.showList&&this.items[this.cursor]&&(this.selectItem(this.items[this.cursor]),this.showList=!1),this.$emit("onEnter",this.items[this.cursor])}}},_e=Ce,ke=(r("b96f"),Object(u["a"])(_e,ve,be,!1,null,null,null)),Pe=ke.exports,we=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("div",[t._v(t._s(t.item.name)+" - "+t._s(t.item.phone||"Not Provided"))]),r("span",[t._v(t._s(t.address))])])},xe=[],Se={props:{item:{required:!0}},computed:{address:function(){return(this.item.address||"Not Provided").substring(0,100)}}},Ie=Se,Oe=Object(u["a"])(Ie,we,xe,!1,null,null,null),$e=Oe.exports,Te=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("b-row",[r("b-col",{staticStyle:{overflow:"hidden"},attrs:{sm:"3"}},[r("img",{attrs:{src:t.item.thumbnail,alt:t.item.name.substring(0,20),width:"50px",height:"50px"}})]),r("b-col",{attrs:{sm:"8"}},[t._v("\n      "+t._s(t.item.name)+"\n      "),r("br"),r("span",{staticClass:"h5"},[t._v(t._s(t._f("currency")(t.item.rndPrice,t.vndConfig)))])])],1)],1)},De=[],Ee={props:{item:{required:!0}},computed:{address:function(){return(this.item.address||"Not Provided").substring(0,100)}}},Me=Ee,Fe=Object(u["a"])(Me,Te,De,!1,null,null,null),Le=Fe.exports,Re={name:"OrderDetailEdit",props:["id"],components:{vueSuggestion:Pe,numberInput:pe},data:function(){return{orderItem:{},sugCustomers:[],sugProducts:[],modalTitle:"",modalId:"",customerSugTemplate:$e,productSugTemplate:Le}},mounted:function(){this.modalId=this.id||"editItemModal"},watch:{},computed:{},methods:{open:function(t){var e=this;this.orderItem=Object(b["a"])({},t),this.modalTitle=this.orderItem&&this.orderItem.customer.name?"Edit Order Item":"Add Order Item",this.$nextTick((function(){return e.$bvModal.show(e.modalId)}))},loadCustomers:function(t,e){var r=this,n=this.$fb.customerCollection.limit(5).orderBy("name");return t&&(n=n.where("nameSearch","array-contains",t.toLowerCase().trim())),e&&(n=n.startAfter(e)),n.get().then((function(t){var e=[];return t.empty||(r.lastSugCustomerVisible=_.last(t.docs),t.forEach((function(t){e.push(t.data())}))),e}))},sugCustomersFocused:function(){var t=this;0==this.sugCustomers.length&&this.loadCustomers().then((function(e){return e.forEach((function(e){return t.sugCustomers.push(e)}))}))},sugCustomersInputChanged:function(t){var e=this;this.customerSugSearchText=t,this.sugCustomers=[],this.lastSugCustomerVisible=void 0,ot&&window.clearTimeout(ot),ot=this.loadCustomers(t).then((function(t){t.forEach((function(t){return e.sugCustomers.push(t)}))}))},loadMoreSugCustomers:function(t){var e=this;this.isLoadingMoreSugCustomer||(this.isLoadingMoreSugCustomer=!0,this.loadCustomers(this.customerSugSearchText,this.lastSugCustomerVisible).then((function(t){t.forEach((function(t){return e.sugCustomers.push(t)})),e.isLoadingMoreSugCustomer=!1})))},sugProductsFocused:function(){var t=this;0==this.sugProducts.length&&this.loadProducts().then((function(e){return e.forEach((function(e){return t.sugProducts.push(e)}))}))},sugProductsInputChanged:function(t){var e=this;this.productSugSearchText=t,this.sugProducts=[],this.lastSugProductVisible=void 0,st&&window.clearTimeout(st),st=this.loadProducts(t).then((function(t){t.forEach((function(t){return e.sugProducts.push(t)}))}))},loadMoreSugProducts:function(t){var e=this;this.isLoadingMoreSugProduct||(this.isLoadingMoreSugProduct=!0,this.loadProducts(this.productSugSearchText,this.lastSugProductVisible).then((function(t){t.forEach((function(t){return e.sugProducts.push(t)})),e.isLoadingMoreSugProduct=!1})))},loadProducts:function(t,e){var r=this,n=this.$fb.productCollection.limit(5).orderBy("name");return t&&(n=n.where("nameSearch","array-contains",t.toLowerCase().trim())),e&&(n=n.startAfter(e)),n.get().then((function(t){var e=[];return t.empty||(r.lastSugProductVisible=_.last(t.docs),t.forEach((function(t){e.push(t.data())}))),e}))},sugProductsItemSelected:function(t){this.orderItem.product.id==t.id?this.orderItem.rndPrice=this.orderItem.rndPrice||t.rndPrice:this.orderItem.rndPrice=t.rndPrice},setLabel:function(t){return t.name},saveOrderItem:function(){this.$emit("saveOrderItem",this.orderItem),this.$bvModal.hide(this.id)}}},Ae=Re,Be=Object(u["a"])(Ae,he,fe,!1,null,null,null),je=Be.exports,Ne={name:"OrderDetail",components:{numberInput:pe,vndPrice:$,productDetail:bt,orderDetailEditItem:je,viewPort:B},data:function(){return{order:[],counter:{},selectedOrderItem:void 0,fields:[{key:"index",label:"#"},{key:"customer.name",label:"Customer",sortable:!0},{key:"product.name",label:"Product"},{key:"price",label:"Price",class:"text-right"},{key:"quantity",label:"Quantity",class:"text-right"},{key:"total",label:"Total",class:"text-right"},{key:"collectedQuantity",label:"Collected Qty",class:"text-center order-detail-collected-quantity"},{key:"collected",label:"Collected",class:"text-center"},{key:"action",class:"text-right"}],mobileFields:[{key:"index",label:""}],product:{}}},mounted:function(){this.loadOrder()},watch:{},computed:{sumQuantity:function(){return this.order.items&&0!=this.order.items.length?this.order.items.reduce((function(t,e){return t+e.quantity}),0):0},sumCollectedQuantity:function(){return this.order.items&&0!=this.order.items.length?this.order.items.reduce((function(t,e){return t+(e.collectedQuantity||0)}),0):0},sumTotal:function(){return this.order.items&&0!=this.order.items.length?this.order.items.reduce((function(t,e){return t+parseFloat(e.rndPrice||e.product.rndPrice)*parseFloat(e.quantity)}),0):0}},methods:{loadOrder:function(){var t=this;this.$fb.orderCollection.doc(this.$route.params.id).onSnapshot((function(e){e.empty||(t.order=e.data(),t.order.items=ne.a.sortBy(t.order.items||[],(function(t){return t.dateCreated})))}))},addNewOrderItem:function(){this.selectedOrderItem={id:(new Date).getTime(),customer:{name:""},product:{name:""},quantity:1,collectedQuantity:0},this.$refs.editItemModal.open(this.selectedOrderItem)},orderItemClicked:function(t){},editOrderItem:function(t){this.selectedOrderItem=Object(b["a"])({},t),this.selectedOrderItem.oriPrice=this.selectedOrderItem.oriPrice||this.selectedOrderItem.product.oriPrice,this.selectedOrderItem.rndPrice=this.selectedOrderItem.rndPrice||this.selectedOrderItem.product.rndPrice,this.$refs.editItemModal.open(this.selectedOrderItem)},deleteOrderItem:function(t){var e=this,r=ne.a.find(this.order.items,(function(e){return e.id==t.id}));r&&this.$bvModal.msgBoxConfirm("Are you sure you want to delete [".concat(r.quantity," - ").concat(r.product.name,"] of [").concat(r.customer.name,"]?")).then((function(r){if(r){var n=ne.a.findIndex(e.order.items,(function(e){return e.id==t.id}));e.order.items.splice(n,1),e.$fb.orderCollection.doc(e.order.id).set(e.order).then((function(){return e.selectedOrderItem=void 0}))}})).catch((function(t){console.log(t)}))},saveOrderItem:function(t){var e=this;if(t.product&&t.customer){delete t.customer.nameSearch,delete t.product.nameSearch,t.quantity=parseFloat(t.quantity),this.order.items=this.order.items||[];var r=this.order.items.findIndex((function(e){return e.id==t.id}));return r>-1?(t.dateModified=new Date,this.order.items.splice(r,1,t)):(t.dateCreated=new Date,this.order.items.push(t)),this.$fb.orderCollection.doc(this.order.id).set(this.order).then((function(){e.selectedOrderItem=void 0}))}},saveAndAddOrderItem:function(){this.saveOrderItem().then(this.addNewOrderItem)},cancelOrderItem:function(){this.selectedOrderItem=void 0},calculateTotalOrderItem:function(t){return parseFloat(t.quantity)*parseFloat(t.rndPrice||t.product.rndPrice)},collectedChanged:function(t,e){e.collected=t,e.collectedQuantity=t?e.quantity:0;var r=this.order.items.findIndex((function(t){return t.id==e.id}));r>-1&&(e.dateModified=new Date,this.order.items.splice(r,1,e),this.$fb.orderCollection.doc(this.order.id).set(this.order))},goToCollectionPage:function(){this.$router.push({name:"OrderDetailCollection",params:{id:this.order.id}})},goToShipmentPage:function(){this.$router.push({name:"OrderDetailShipment",params:{id:this.order.id}})},goToOrderList:function(){this.$router.push({name:"Orders"})},collectedQuantityChanged:function(t,e){var r=this;t.collectedQuantity=e,t.collected=t.collectedQuantity==t.quantity,at&&window.clearTimeout(at),at=window.setTimeout((function(){return r.$fb.orderCollection.doc(r.order.id).set(r.order)}),1e3)},showProductDetailModal:function(t){var e=this,r=t.product.id;this.$fb.productCollection.doc(r).get().then((function(t){e.product=t.data(),e.$refs.productDetail.open(e.product)}))},productSaved:function(t){}}},qe=Ne,Qe=(r("6210"),Object(u["a"])(qe,te,ee,!1,null,"04f838bc",null)),Ve=Qe.exports,ze=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"animated fadeIn"},[r("b-row",[r("b-col",[r("b-card",[r("div",{attrs:{slot:"header"},slot:"header"},[r("b-link",{on:{click:t.goToOrderList}},[r("i",{staticClass:"fa fa-server"}),t._v(" Order:\n          ")]),r("strong",[t._v(t._s(t.order.name))]),r("div",{staticClass:"pull-right"},[r("b-link",{on:{click:t.goToOrderDetailPage}},[t._v("Order Detail Page")])],1)],1),r("view-port",{scopedSlots:t._u([{key:"desktop",fn:function(){return[r("div",[r("b-table",{attrs:{"foot-clone":"",responsive:"sm",items:t.items,fields:t.fields,small:!0},scopedSlots:t._u([{key:"cell(index)",fn:function(e){return[t._v(t._s(e.index+1))]}},{key:"cell(total)",fn:function(e){return[t._v(t._s(t._f("currency")(t.calculateTotalOrderItem(e.item),t.vndConfig)))]}},{key:"cell(name)",fn:function(e){return[t._v("\n                  "+t._s(e.item.name)+"\n                  "),e.item.cwProductId?r("b-link",{attrs:{href:t.appSettings.cwBuyProductUrl.replace("{id}",e.item.cwProductId),target:"_blank"}},[t._v("[Buy CW]")]):t._e(),r("br"),r("strong",[t._v("CW:")]),t._v("\n                  "+t._s(t._f("currency")(e.item.product.cwSalePrice?e.item.product.cwSalePrice:e.item.product.cwPrice,t.audConfig))+"\n                  "),e.item.product.cwSalePricePick?r("b-badge",{attrs:{variant:"success"}},[t._v("CW Sale")]):t._e(),t._v("-\n                  "),r("strong",[t._v("BV:")]),t._v("\n                  "+t._s(t._f("currency")(e.item.product.bvSalePrice?e.item.product.bvSalePrice:e.item.product.bvPrice,t.audConfig))+"\n                  "),e.item.product.bvSalePricePick?r("b-badge",{attrs:{variant:"success"}},[t._v("BV Sale")]):t._e()]}},{key:"cell(collectedQuantity)",fn:function(e){return[r("number-input",{attrs:{min:0,max:e.item.quantity,inline:"",controls:"",center:"",size:"sm"},on:{change:function(r){return t.collectedQuantityChanged(e.item,r)}},model:{value:e.item.collectedQuantity,callback:function(r){t.$set(e.item,"collectedQuantity",r)},expression:"data.item.collectedQuantity"}})]}},{key:"cell(collected)",fn:function(e){return[r("b-form-checkbox",{on:{change:function(r){return t.collectedChanged(r,e.item)}},model:{value:e.item.collected,callback:function(r){t.$set(e.item,"collected",r)},expression:"data.item.collected"}})]}},{key:"cell(action)",fn:function(e){return[r("b-button",{staticClass:"mr-1",attrs:{type:"submit",size:"sm",variant:"success"}},[r("i",{staticClass:"fa fa-edit"}),t._v(" Edit\n                  ")]),r("b-button",{attrs:{type:"submit",size:"sm",variant:"danger"},on:{click:function(r){return t.deleteOrderItem(e.item)}}},[r("i",{staticClass:"fa fa-remove"}),t._v(" Delete\n                  ")])]}},{key:"foot()",fn:function(t){}},{key:"foot(quantity)",fn:function(e){return[t._v(t._s(t.sumQuantity))]}},{key:"foot(collectedQuantity)",fn:function(e){return[t._v(t._s(t.sumCollectedQuantity))]}}])})],1)]},proxy:!0},{key:"mobile",fn:function(){return[r("b-table",{attrs:{"foot-clone":"",responsive:"sm",items:t.items,fields:t.mobileFields,small:!0},scopedSlots:t._u([{key:"cell(index)",fn:function(e){return[r("b-row",[r("b-col",[r("strong",[t._v(t._s(e.index+1)+". "+t._s(e.item.name))]),e.item.cwProductId?r("b-link",{staticClass:"ml-1",attrs:{href:t.appSettings.cwBuyProductUrl.replace("{id}",e.item.cwProductId),target:"_blank"}},[t._v("[Buy CW]")]):t._e(),r("br"),t._v("\n                    CW:\n                    "+t._s(t._f("currency")(e.item.product.cwSalePrice?e.item.product.cwSalePrice:e.item.product.cwPrice,t.audConfig))+"\n                    "),e.item.product.cwSalePricePick?r("b-badge",{attrs:{variant:"success"}},[t._v("CW Sale")]):t._e(),t._v("\n                    -\n                    BV:\n                    "+t._s(t._f("currency")(e.item.product.bvSalePrice?e.item.product.bvSalePrice:e.item.product.bvPrice,t.audConfig))+"\n                    "),e.item.product.bvSalePricePick?r("b-badge",{attrs:{variant:"success"}},[t._v("BV Sale")]):t._e()],1)],1),r("b-row",[r("b-col",[t._v("\n                    Quantity:\n                    "),r("strong",[t._v(t._s(e.item.quantity))]),t._v("\n                    ("+t._s(e.item.customerNameQty)+")\n                  ")])],1),r("b-row",{staticClass:"mt-2"},[r("b-col",{attrs:{cols:"6"}},[r("number-input",{attrs:{min:0,max:e.item.quantity,inline:"",controls:"",center:"",size:"sm"},on:{change:function(r){return t.collectedQuantityChanged(e.item,r)}},model:{value:e.item.collectedQuantity,callback:function(r){t.$set(e.item,"collectedQuantity",r)},expression:"data.item.collectedQuantity"}})],1),r("b-col",{staticClass:"text-center",staticStyle:{"padding-top":"5px"},attrs:{cols:"6"}},[r("b-form-checkbox",{on:{change:function(r){return t.collectedChanged(r,e.item)}},model:{value:e.item.collected,callback:function(r){t.$set(e.item,"collected",r)},expression:"data.item.collected"}})],1)],1)]}},{key:"foot()",fn:function(e){return[r("hr"),r("b-row",[r("b-col",[t._v("Quantity")]),r("b-col",{staticClass:"text-right"},[t._v(t._s(t.sumQuantity))])],1),r("b-row",[r("b-col",[t._v("Collected Qty")]),r("b-col",{staticClass:"text-right"},[t._v(t._s(t.sumCollectedQuantity))])],1)]}}])})]},proxy:!0}])})],1)],1)],1)],1)},We=[],Ue=(r("cadf"),{name:"OrderDetail",components:{numberInput:pe,viewPort:B},data:function(){return{order:{},items:[],fields:[{key:"index",label:"#",class:"collection-index"},{key:"name",label:"Product",class:"collection-name"},{key:"customerNameQty",label:"Detail",class:"collection-detail"},{key:"quantity",label:"Quantity",class:"text-right collection-qty"},{key:"collectedQuantity",label:"Collected Qty",class:"text-center collection-collected-qty"},{key:"collected",label:"Collected",class:"text-center collection-collected"}],mobileFields:[{key:"index",label:""}]}},mounted:function(){this.loadOrder()},computed:{sumQuantity:function(){return this.items&&0!==this.items.length?ne.a.sumBy(this.items,(function(t){return t.quantity})):0},sumCollectedQuantity:function(){return this.items&&0!==this.items.length?ne.a.sumBy(this.items,(function(t){return t.collectedQuantity})):0}},methods:{loadOrder:function(){var t=this;this.$fb.orderCollection.doc(this.$route.params.id).onSnapshot((function(e){e.empty||(t.order=e.data(),t.items=ne.a.chain(t.order.items).map((function(t){return{id:t.id,name:t.product.name,cwProductId:t.product.cwProductId,quantity:t.quantity,collectedQuantity:t.collectedQuantity,product:t.product,collected:t.collected,customerName:t.customer.name}})).groupBy((function(t){return t.name})).mapValues((function(t){var e={name:ne.a.first(t).name,product:ne.a.first(t).product,cwProductId:ne.a.first(t).cwProductId,quantity:ne.a.sumBy(t,(function(t){return parseFloat(t.quantity)})),collectedQuantity:ne.a.sumBy(t,(function(t){return parseFloat(t.collectedQuantity)})),orderItemIds:ne.a.reduce(t,(function(t,e){return t.concat(e.id)}),[]),customerNameQty:ne.a.map(t,(function(t){return t.customerName+": "+t.quantity})).join(", ")};return e.collected=e.quantity==e.collectedQuantity,e})).values().orderBy("name").value())}))},goToOrderDetailPage:function(){this.$router.push({name:"OrderDetail",params:{id:this.order.id}})},collectedChanged:function(t,e){e.collectedQuantity=t?e.quantity:0,this.setCollectedItem(e)},setCollectedItem:function(t){var e=t.orderItemIds,r=t.collectedQuantity;this.order.items.filter((function(t){return e.indexOf(t.id)>-1})).forEach((function(t){t.collectedQuantity=0,t.collected=!1,r>0&&(r>t.quantity?(t.collectedQuantity=t.quantity,t.collected=!0,r-=t.quantity):(t.collectedQuantity=r,r=0,t.collected=t.collectedQuantity==t.quantity))})),this.debounceSaveOrder()},goToOrderList:function(){this.$router.push({name:"Orders"})},collectedQuantityChanged:function(t,e){t.collectedQuantity=e,this.setCollectedItem(t)},debounceSaveOrder:function(){var t=this;ct&&window.clearTimeout(ct),ct=window.setTimeout((function(){return t.$fb.orderCollection.doc(t.order.id).set(t.order)}),500)}}}),He=Ue,Ye=Object(u["a"])(He,ze,We,!1,null,null,null),Ke=Ye.exports,Je=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"animated fadeIn"},[r("b-row",[r("b-col",[r("b-card",[r("div",{attrs:{slot:"header"},slot:"header"},[r("b-link",{on:{click:t.goToOrderList}},[r("i",{staticClass:"fa fa-server"}),t._v(" Order:\n          ")]),r("strong",[t._v(t._s(t.order.name))]),t.isAdmin?r("div",{staticClass:"pull-right"},[r("b-link",{staticClass:"mr-1",on:{click:t.updateCustomerInformation}},[t._v("Update Customer Information |")]),r("b-link",{on:{click:t.goToOrderDetailPage}},[t._v("Order Detail Page")])],1):t._e()],1),r("view-port",{scopedSlots:t._u([{key:"desktop",fn:function(){return[r("div",[r("b-table",{attrs:{"foot-clone":"",responsive:"sm",items:t.items,fields:t.fields,small:!0,hover:!0},scopedSlots:t._u([{key:"cell(index)",fn:function(e){return[t._v(t._s(e.index+1))]}},{key:"cell(customerName)",fn:function(e){return[r("b-link",{on:{click:function(r){return t.editCustomer(e)}}},[t._v(t._s(e.value))]),e.item.customerId?t._e():r("b-link",{staticClass:"ml-1",on:{click:function(r){return t.updateCustomer(e.item)}}},[t._v("[Update Info]")])]}},{key:"cell(products)",fn:function(e){return[r("table",{staticClass:"table table-borderless product-table"},t._l(e.item.products,(function(e,n){return r("tr",{key:n},[r("td",[t._v(t._s(e.productName))]),r("td",{staticClass:"text-right",staticStyle:{width:"5%"}},[t._v(t._s(e.quantity))]),r("td",{staticClass:"text-right",staticStyle:{width:"25%"}},[t._v(t._s(t._f("currency")(e.total,t.vndConfig)))])])})),0)]}},{key:"cell(productPrice)",fn:function(e){return t._l(e.item.products,(function(e,n){return r("div",{key:n},[r("span",[t._v(t._s(t._f("currency")(e.total,t.vndConfig)))])])}))}},{key:"cell(quantity)",fn:function(e){return[r("strong",[t._v(t._s(e.value))])]}},{key:"cell(total)",fn:function(e){return[r("strong",[t._v(t._s(t._f("currency")(e.value,t.vndConfig)))])]}},{key:"cell(purchased)",fn:function(e){return[r("b-form-checkbox",{on:{change:function(r){return t.purchasedChanged(r,e)}},model:{value:e.item.purchased,callback:function(r){t.$set(e.item,"purchased",r)},expression:"data.item.purchased"}})]}},{key:"cell(action)",fn:function(e){return[r("b-button",{attrs:{type:"submit",size:"sm",variant:"success"},on:{click:function(r){return t.editShipmentItem(e)}}},[r("i",{staticClass:"fa fa-edit"}),t._v(" Edit\n                  ")])]}},{key:"foot()",fn:function(t){}},{key:"foot(quantity)",fn:function(e){return[t._v(t._s(t.sumQuantity))]}},{key:"foot(total)",fn:function(e){return[t._v(t._s(t._f("currency")(t.sumTotal,t.vndConfig)))]}},{key:"foot(purchased)",fn:function(e){return[t._v(t._s(t._f("currency")(t.sumPurchased,t.vndConfig)))]}}])})],1)]},proxy:!0},{key:"mobile",fn:function(){return[r("b-table",{attrs:{"foot-clone":"",responsive:"sm",items:t.items,fields:t.mobileFields,small:!0,hover:!0},scopedSlots:t._u([{key:"cell(index)",fn:function(e){return[r("b-row",[r("b-col",[r("strong",[t._v(t._s(e.index+1)+". "+t._s(e.item.customerName))]),r("b-link",{staticClass:"ml-1",on:{click:function(r){return t.editCustomer(e)}}},[t._v("[Edit]")]),e.item.customerId?t._e():r("b-link",{staticClass:"ml-1",on:{click:function(r){return t.updateCustomer(e.item)}}},[t._v("[Update Info]")])],1)],1),r("b-row",[r("b-col",[r("table",{staticClass:"table table-borderless product-table"},[t._l(e.item.products,(function(e,n){return r("tr",{key:n},[r("td",[t._v(t._s(e.productName))]),r("td",{staticClass:"text-right",staticStyle:{width:"5%"}},[t._v(t._s(e.quantity))]),r("td",{staticClass:"text-right",staticStyle:{width:"30%"}},[t._v(t._s(t._f("currency")(e.total,t.vndConfig)))])])})),r("tr",{staticStyle:{"border-top":"1px dashed #e4e7ea !important"}},[r("td",[t._v("Total")]),r("td",{staticClass:"text-right",staticStyle:{width:"5%"}},[t._v(t._s(e.item.quantity))]),r("td",{staticClass:"text-right",staticStyle:{width:"30%"}},[t._v(t._s(t._f("currency")(e.item.total,t.vndConfig)))])]),r("tr",[r("td",[t._v("Purchased")]),r("td",{staticClass:"text-right",staticStyle:{width:"5%"}}),r("td",{staticClass:"text-center",staticStyle:{width:"30%"}},[r("b-form-checkbox",{on:{change:function(r){return t.purchasedChanged(r,e)}},model:{value:e.item.purchased,callback:function(r){t.$set(e.item,"purchased",r)},expression:"data.item.purchased"}})],1)])],2)])],1),r("fieldset",{staticClass:"my-fieldset",staticStyle:{"margin-top":"10px"}},[r("b-row",[r("b-col",[t._v("\n                      Note: "+t._s(e.item.note)+"\n                      "),r("br"),t._v("\n                      Address: "+t._s(e.item.address)+"\n                      "),r("br"),t._v("\n                      Phone: "+t._s(e.item.phone)+"\n                      "),r("br"),r("b-link",{on:{click:function(r){return t.editShipmentItem(e)}}},[r("i",{staticClass:"fa fa-edit"}),t._v(" Edit\n                      ")])],1)],1)],1)]}},{key:"foot()",fn:function(e){return[r("hr"),r("b-row",[r("b-col",[t._v("Quantity")]),r("b-col",{staticClass:"text-right"},[t._v(t._s(t.sumQuantity))])],1),r("b-row",[r("b-col",[t._v("Total")]),r("b-col",{staticClass:"text-right"},[t._v(t._s(t._f("currency")(t.sumTotal,t.vndConfig)))])],1),r("b-row",[r("b-col",[t._v("Purchased")]),r("b-col",{staticClass:"text-right"},[t._v(t._s(t._f("currency")(t.sumPurchased,t.vndConfig)))])],1)]}}])})]},proxy:!0}])})],1)],1)],1),r("order-detail-shipment-edit-item",{attrs:{id:"shipmentEditItem",item:t.selectedShipmentItem},on:{saveShipmentItem:t.saveShipmentItem}}),r("customer-edit",{attrs:{id:"customerEdit",item:this.selectedCustomer}})],1)},Ge=[],Xe=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("b-modal",{attrs:{id:t.id,title:"Shipment Item",size:"lg"},on:{ok:t.saveShipmentItem}},[r("b-row",[r("b-col",{attrs:{sm:"12"}},[r("b-form-group",[r("label",[t._v("Note")]),r("b-form-input",{attrs:{type:"text"},model:{value:t.shipmentItem.note,callback:function(e){t.$set(t.shipmentItem,"note",e)},expression:"shipmentItem.note"}})],1)],1),r("b-col",{attrs:{sm:"12"}},[r("b-form-group",[r("label",[t._v("Address")]),r("b-form-input",{attrs:{type:"text"},model:{value:t.shipmentItem.address,callback:function(e){t.$set(t.shipmentItem,"address",e)},expression:"shipmentItem.address"}})],1)],1),r("b-col",{attrs:{sm:"12"}},[r("b-form-group",[r("label",[t._v("Phone")]),r("b-form-input",{attrs:{type:"text"},model:{value:t.shipmentItem.phone,callback:function(e){t.$set(t.shipmentItem,"phone",e)},expression:"shipmentItem.phone"}})],1)],1)],1)],1)},Ze=[],tr={name:"OrderDetail",props:["id","item"],components:{},data:function(){return{shipmentItem:{}}},watch:{item:function(t){this.shipmentItem=t||{}}},mounted:function(){},computed:{},methods:{saveShipmentItem:function(){this.$emit("saveShipmentItem",this.shipmentItem),this.$bvModal.hide(this.id)}}},er=tr,rr=Object(u["a"])(er,Xe,Ze,!1,null,"7c39920c",null),nr=rr.exports,ir=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("b-modal",{attrs:{id:t.id,title:"Customer Detail",size:"lg"},on:{ok:t.saveCustomer}},[r("b-row",[r("b-col",{attrs:{sm:"12"}},[r("b-form-group",[r("label",[t._v("Name")]),r("b-form-input",{attrs:{type:"text"},model:{value:t.customer.name,callback:function(e){t.$set(t.customer,"name",e)},expression:"customer.name"}})],1)],1),r("b-col",{attrs:{sm:"12"}},[r("b-form-group",[r("label",[t._v("Address")]),r("b-form-input",{attrs:{type:"text"},model:{value:t.customer.address,callback:function(e){t.$set(t.customer,"address",e)},expression:"customer.address"}})],1)],1),r("b-col",{attrs:{sm:"12"}},[r("b-form-group",[r("label",[t._v("Phone")]),r("b-form-input",{attrs:{type:"text"},model:{value:t.customer.phone,callback:function(e){t.$set(t.customer,"phone",e)},expression:"customer.phone"}})],1)],1)],1)],1)},sr=[],or={name:"CustomerEdit",props:["id","item"],components:{},data:function(){return{customer:{}}},watch:{item:function(t){var e=this;this.customer=t||{},this.customer.id&&this.$fb.customerCollection.doc(this.customer.id).get().then((function(t){return e.customer=t.data()}))}},mounted:function(){},computed:{},methods:{saveCustomer:function(){var t=this;this.customer.nameSearch=T(this.customer.name),this.customer.version=(this.customer.version||0)+1,this.$fb.customerCollection.doc(this.customer.id).set(this.customer).then((function(){t.$emit("customerSaved",t.customer),t.$bvModal.hide(t.id)}))}}},ar=or,cr=Object(u["a"])(ar,ir,sr,!1,null,"2daaf116",null),ur=cr.exports,lr={name:"OrderDetail",components:{numberInput:pe,orderDetailShipmentEditItem:nr,customerEdit:ur,viewPort:B},data:function(){return{isAdmin:!1,order:{},items:[],selectedShipmentItem:{},selectedCustomer:{},fields:[{key:"index",label:"#",class:"shipment-index-col"},{key:"customerName",label:"Customer",class:"shipment-customer-col"},{key:"products",label:"Products",class:"shipment-product-col"},{key:"quantity",label:"Total Qty",class:"text-center shipment-quantity-col",tdClass:"vertical-middle"},{key:"total",label:"Total Price",class:"text-right shipment-price-col"},{key:"purchased",label:"Purchased",class:"text-center shipment-purchased-col"},{key:"note",label:"Note",class:"shipment-note-col"},{key:"address",label:"Address",class:"shipment-address-col"},{key:"phone",label:"Phone",class:"shipment-phone-col"},{key:"action",label:"Action",class:"text-right shipment-action-col"}],mobileFields:[{key:"index",label:""}]}},mounted:function(){this.isAdmin=this.$fb.isAdmin(),this.loadOrder()},computed:{sumQuantity:function(){return this.items&&0!==this.items.length?ne.a.sumBy(this.items,(function(t){return t.quantity})):0},sumTotal:function(){return this.items&&0!==this.items.length?ne.a.sumBy(this.items,(function(t){return t.total})):0},sumPurchased:function(){return this.items&&0!==this.items.length?ne.a.chain(this.items).filter((function(t){return t.purchased})).sumBy((function(t){return t.total})).value():0}},methods:{loadOrder:function(){var t=this;this.$fb.orderCollection.doc(this.$route.params.id).onSnapshot((function(e){e.empty||(t.order=e.data(),t.buildItems(t.order))}))},buildItems:function(t){this.items=ne.a.chain(t.items).map((function(t){return{id:t.id,customerId:t.customer.id,note:t.note,customerName:t.customer.name,address:t.customer.address,phone:t.customer.phone,purchased:t.purchased,productName:t.product.name,quantity:t.quantity,rndPrice:t.rndPrice||t.product.rndPrice,total:parseFloat(t.quantity||0)*parseFloat(t.rndPrice||t.product.rndPrice||0)}})).groupBy((function(t){return t.customerName})).mapValues((function(t){var e={note:ne.a.first(t).note,customerId:ne.a.first(t).customerId,customerName:ne.a.first(t).customerName,address:ne.a.first(t).address,phone:ne.a.first(t).phone,purchased:ne.a.first(t).purchased,quantity:ne.a.sumBy(t,(function(t){return t.quantity})),total:ne.a.sumBy(t,(function(t){return t.total})),products:ne.a.reduce(t,(function(t,e){return t.concat(e)}),[])};return e})).values().sortBy((function(t){return t.customerName})).value()},goToOrderDetailPage:function(){this.$router.push({name:"OrderDetail",params:{id:this.order.id}})},collectedChanged:function(t,e){e.collectedQuantity=t?e.quantity:0,this.setCollectedItem(e)},setCollectedItem:function(t){var e=t.orderItemIds,r=t.collectedQuantity;this.order.items.filter((function(t){return e.indexOf(t.id)>-1})).forEach((function(t){t.collectedQuantity=0,t.collected=!1,r>0&&(r>t.quantity?(t.collectedQuantity=t.quantity,t.collected=!0,r-=t.quantity):(t.collectedQuantity=r,r=0,t.collected=t.collectedQuantity==t.quantity))})),this.debounceSaveOrder()},goToOrderList:function(){this.$router.push({name:"Orders"})},collectedQuantityChanged:function(t,e){t.collectedQuantity=e,this.setCollectedItem(t)},debounceSaveOrder:function(){var t=this;ut&&window.clearTimeout(ut),ut=window.setTimeout((function(){return t.$fb.orderCollection.doc(t.order.id).set(t.order)}),500)},updateCustomerInformation:function(){var t=this;this.$bvModal.msgBoxConfirm("Are you sure you want to update all Customer's informations?").then((function(e){e&&t.items.forEach(t.updateCustomer)})).catch((function(t){console.log(t)}))},updateCustomer:function(t){var e=this,r=this.$fb.customerCollection;r=t.customerId?r.doc(t.customerId):r.where("name","==",t.customerName),r.get().then((function(e){var r;return r=t.customerId?e.data():ne.a.first(e.docs).data(),delete r.nameSearch,r})).then((function(t){var r=ne.a.keys(ne.a.pickBy(e.order.items,(function(e){return e.customer.id==t.id||e.customer.name==t.name})));return r.forEach((function(r){var n=e.order.items[r];n.customer=t,e.order.items.splice(r,1,n)})),e.$fb.orderCollection.doc(e.order.id).set(e.order),e.order})).then(this.buildItems)},purchasedChanged:function(t,e){var r=this,n=e.index,i=e.item;i.purchased=t,this.items.splice(n,1,i);var s=ne.a.keys(ne.a.pickBy(this.order.items,(function(t){return t.customer.id==i.customerId||t.customer.name==i.customerName})));s.forEach((function(e){return r.order.items[e].purchased=t})),this.debounceSaveOrder()},editShipmentItem:function(t){var e=t.index,r=t.item;this.selectedShipmentItem=Object(b["a"])({},r),this.selectedShipmentItemIndex=e,this.$bvModal.show("shipmentEditItem")},saveShipmentItem:function(t){var e=this;this.items.splice(this.selectedShipmentItemIndex,1,t);var r=ne.a.keys(ne.a.pickBy(this.order.items,(function(e){return e.customer.id==t.customerId||e.customer.name==t.customerName})));r.forEach((function(r){e.order.items[r].note=t.note,e.order.items[r].customer.address=t.address,e.order.items[r].customer.phone=t.phone})),this.debounceSaveOrder()},editCustomer:function(t){t.index;var e=t.item,r=e.customerId,n=e.customerName,i=e.address,s=e.phone;this.selectedCustomer={id:r,name:n,address:i,phone:s},this.$bvModal.show("customerEdit")}}},dr=lr,mr=(r("d8da"),Object(u["a"])(dr,Je,Ge,!1,null,"3950ec13",null)),pr=mr.exports,hr=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"animated fadeIn"},[r("b-card",[r("div",{attrs:{slot:"header"},slot:"header"},[r("i",{staticClass:"cui-user icons font-lg"}),t._v("\n      "+t._s(t.order.name)+" Statistic\n    ")]),r("b-row",[r("b-col",{attrs:{sm:"12",md:"6"}},[r("table",{staticClass:"table table-response"},[r("tr",{staticClass:"no-border-top"},[r("td",[t._v("Buying")]),r("td",{staticClass:"text-right"},[t._v(t._s(t._f("currency")(t.totalBuying,t.audConfig)))])]),r("tr",[r("td",[t._v("\n              Ship VN Fee\n              "),r("a",{attrs:{href:"javascript:void(0)"},on:{click:t.changeShipFee}},[t._v("[Change]")])]),t.isChangingShipFee?r("td",{staticClass:"text-right"},[r("b-input-group",[r("b-form-input",{model:{value:t.order.shipFee,callback:function(e){t.$set(t.order,"shipFee",e)},expression:"order.shipFee"}}),r("b-input-group-append",[r("b-button",{attrs:{variant:"outline-success"},on:{click:t.saveShipFee}},[t._v("Save")])],1)],1)],1):r("td",{staticClass:"text-right"},[t._v("(Est: "+t._s(t._f("currency")(t.estShipPrice,t.audConfig))+") "+t._s(t._f("currency")(t.order.shipFee,t.audConfig)))])]),r("tr",[r("td",[t._v("Total")]),r("td",{staticClass:"text-right"},[t._v(t._s(t._f("currency")(t.total,t.audConfig)))])]),r("tr",[r("td",[t._v("\n              Current Rate\n              "),r("a",{attrs:{href:"javascript:void(0)"},on:{click:t.changeCurrentRate}},[t._v("[Change]")])]),t.isChangingCurrentRate?t._e():r("td",{staticClass:"text-right"},[t._v(t._s(t._f("currency")(t.order.currentRate,t.vndConfig)))]),t.isChangingCurrentRate?r("td",{staticClass:"text-right"},[r("b-input-group",[r("b-form-input",{model:{value:t.order.currentRate,callback:function(e){t.$set(t.order,"currentRate",e)},expression:"order.currentRate"}}),r("b-input-group-append",[r("b-button",{attrs:{variant:"outline-success"},on:{click:t.saveCurrentRate}},[t._v("Save")])],1)],1)],1):t._e()]),r("tr",[r("td",[t._v("Total VND")]),r("td",{staticClass:"text-right"},[t._v(t._s(t._f("currency")(t.totalVND,t.vndConfig)))])]),r("tr",[r("td",[t._v("Profit")]),r("td",{staticClass:"text-right"},[r("strong",[t._v(t._s(t._f("currency")(t.profit,t.vndConfig)))])])])])]),r("b-col",{attrs:{sm:"12",md:"6"}},[r("b-form-group",[r("label",[t._v("Note")]),r("b-form-textarea",{attrs:{placeholder:"Enter something...",rows:"6"},model:{value:t.order.note,callback:function(e){t.$set(t.order,"note",e)},expression:"order.note"}})],1),r("b-button",{attrs:{type:"submit",size:"sm",variant:"success"},on:{click:t.saveOrder}},[t._v("Save")])],1)],1)],1)],1)},fr=[],vr={name:"Orders",components:{},data:function(){return{order:[],counter:{},totalBuying:0,total:0,totalVND:0,profit:0,estShipPrice:0,isChangingShipFee:!1,isChangingCurrentRate:!1}},mounted:function(){this.loadOrder()},watch:{"$route.params.id":function(){this.loadOrder()}},computed:{},methods:{loadOrder:function(){var t=this,e=this.$route.params.id;this.$fb.orderCollection.doc(e).onSnapshot((function(e){e.empty||(t.order=e.data(),t.calculateStatistic(t.order))}))},calculateStatistic:function(t){this.totalBuying=_.sumBy(t.items,(function(t){return parseFloat(t.product.buyPrice||0)*parseFloat(t.quantity||0)})),this.total=this.totalBuying+(t&&t.shipFee||0),this.estShipPrice=this.sumShippingFee(t),this.totalVND=this.total*(t&&t.currentRate||16500),this.profit=this.sumTotal(t)-this.totalVND},sumQuantity:function(t){return t.items&&0!=t.items.length?t.items.reduce((function(t,e){return t+e.quantity}),0):0},sumTotal:function(t){return t.items&&0!=t.items.length?t.items.reduce((function(t,e){return t+e.quantity*parseFloat(e.rndPrice||e.product.rndPrice)}),0):0},sumShippingFee:function(t){return t.items&&0!=t.items.length?t.items.reduce((function(t,e){return t+e.quantity*parseFloat(e.product.shipPrice||0)}),0):0},changeShipFee:function(){this.isChangingShipFee=!0},changeCurrentRate:function(){this.isChangingCurrentRate=!0},saveShipFee:function(){this.order.shipFee=parseFloat(this.order.shipFee),this.isChangingShipFee=!1,this.saveOrder()},saveCurrentRate:function(){this.order.currentRate=parseFloat(this.order.currentRate),this.saveOrder()},saveOrder:function(){var t=this;this.$fb.orderCollection.doc(this.order.id).set(this.order).then((function(e){t.isChangingCurrentRate=!1}))}}},br=vr,gr=(r("a3b2"),Object(u["a"])(br,hr,fr,!1,null,"0fe54fc7",null)),yr=gr.exports,Cr=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"animated fadeIn"},[r("b-card",[r("div",{attrs:{slot:"header"},slot:"header"},[t._v("Calculate Price")]),r("b-form",[r("b-form-group",{attrs:{label:"Price ($A)"}},[r("b-form-input",{attrs:{type:"text",placeholder:"Enter price"},model:{value:t.price,callback:function(e){t.price=e},expression:"price"}})],1),r("b-form-group",{attrs:{label:"Weight(g)",description:"100g = $1"}},[r("b-form-input",{attrs:{type:"text",placeholder:"Enter weight"},model:{value:t.weight,callback:function(e){t.weight=e},expression:"weight"}})],1),r("b-form-group",{attrs:{label:"Suggested Price (Price + 10% + Ship + 2)"}},[t._v("\n        ("+t._s(t._f("currency")(t.price,t.audConfig))+" + "+t._s(t._f("currency")(.1*t.price,t.audConfig))+" + "+t._s(t._f("currency")(t.weight/100,t.audConfig))+" + "+t._s(t._f("currency")(2,t.audConfig))+") * "+t._s(t._f("currency")(16500,t.vndConfig))+"\n        "),r("strong",[t._v("= "+t._s(t._f("currency")(t.sugPrice,t.vndConfig)))])])],1)],1)],1)},_r=[],kr={name:"Utils",components:{},data:function(){return{price:"",weight:""}},mounted:function(){},computed:{sugPrice:function(){var t=parseFloat(this.price||0),e=parseFloat(this.weight||0);return 16500*(t+.1*t+e/100+2)}},methods:{}},Pr=kr,wr=Object(u["a"])(Pr,Cr,_r,!1,null,null,null),xr=wr.exports,Sr=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"app flex-row align-items-center"},[r("div",{staticClass:"container"},[r("b-row",{staticClass:"justify-content-center"},[r("b-col",{attrs:{md:"8"}},[r("b-card-group",[r("b-card",{staticClass:"p-4",attrs:{"no-body":""}},[r("b-card-body",[r("b-form",{on:{submit:t.login}},[r("h1",[t._v("Login")]),r("p",{staticClass:"text-muted"},[t._v("Sign In to your account")]),r("b-input-group",{staticClass:"mb-3"},[r("b-input-group-prepend",[r("b-input-group-text",[r("i",{staticClass:"fa fa-user"})])],1),r("b-form-input",{staticClass:"form-control",attrs:{type:"text",placeholder:"Username",autocomplete:"username email"},model:{value:t.email,callback:function(e){t.email=e},expression:"email"}})],1),r("b-input-group",{staticClass:"mb-4"},[r("b-input-group-prepend",[r("b-input-group-text",[r("i",{staticClass:"fa fa-lock"})])],1),r("b-form-input",{staticClass:"form-control",attrs:{type:"password",placeholder:"Password",autocomplete:"current-password"},model:{value:t.password,callback:function(e){t.password=e},expression:"password"}})],1),t.showError?r("p",[r("i",{staticStyle:{color:"red"}},[t._v("Wrong username or password")])]):t._e(),r("b-row",[r("b-col",{attrs:{cols:"6"}},[r("b-button",{staticClass:"px-4",attrs:{variant:"primary"},on:{click:t.login}},[t._v("Login")])],1),r("b-col",{staticClass:"text-right",attrs:{cols:"6"}},[r("b-button",{staticClass:"px-0",attrs:{variant:"link"}},[t._v("Forgot password?")])],1)],1)],1)],1)],1),r("b-card",{staticClass:"text-white bg-primary py-5 d-md-down-none",staticStyle:{width:"44%"},attrs:{"no-body":""}},[r("b-card-body",{staticClass:"text-center"},[r("div",[r("h2",[t._v("Chemist Order Management")])])])],1)],1)],1)],1)],1)])},Ir=[],Or={name:"Login",data:function(){return{email:"",password:"",showError:!1}},methods:{login:function(){var t=this;this.$fb.auth.signInWithEmailAndPassword(this.email,this.password).then((function(){t.$router.replace("dashboard")})).catch((function(e){return t.showError=!0}))}}},$r=Or,Tr=Object(u["a"])($r,Sr,Ir,!1,null,null,null),Dr=Tr.exports,Er=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"animated fadeIn"},[r("b-row",[r("b-col",[r("b-card",[r("div",{attrs:{slot:"header"},slot:"header"},[r("i",{staticClass:"cui-user icons font-lg"}),t._v(" Orders\n        ")]),r("b-table",{attrs:{responsive:"sm",items:t.orders,fields:t.fields,small:!0,selectable:"","select-mode":"single",busy:t.isLoadingData},scopedSlots:t._u([{key:"cell(name)",fn:function(e){return[r("a",{staticStyle:{"font-size":"15px"},attrs:{href:t.buildRoute(e.item),variant:"link"}},[t._v(t._s(e.item.name))])]}},{key:"cell(dateCreated)",fn:function(e){return[t._v(t._s(t._f("date")(e.item.dateCreated.toDate())))]}},{key:"cell(quantity)",fn:function(e){return[t._v(t._s(t.sumQuantity(e.item)))]}},{key:"cell(total)",fn:function(e){return[t._v(t._s(t._f("currency")(t.sumTotal(e.item),t.vndConfig)))]}}])})],1)],1)],1)],1)},Mr=[],Fr={name:"Orders",components:{},data:function(){return{orders:[],counter:{},selectedOrder:{},isLoadingData:!1,fields:[{key:"name"},{key:"dateCreated",label:"Created Date"},{key:"quantity",label:"Quantity"},{key:"total",label:"Total"}]}},mounted:function(){this.loadOrders(),this.loadCounter()},computed:{},methods:{loadCounter:function(){var t=this;this.$fb.counterCollection.limit(1).onSnapshot((function(e){e.empty||e.forEach((function(e){t.counter=e.data(),t.counter.id=e.id}))}))},loadOrders:function(){var t=this;this.orders=[],this.isLoadingData=!0,this.$fb.orderCollection.orderBy("dateCreated","desc").limit(10).get().then((function(e){e.empty||e.forEach((function(e){return t.orders.push(e.data())}))})).then((function(){return t.isLoadingData=!1}))},sumQuantity:function(t){return t.items&&0!=t.items.length?t.items.reduce((function(t,e){return t+e.quantity}),0):0},sumTotal:function(t){return t.items&&0!=t.items.length?t.items.reduce((function(t,e){return t+e.quantity*parseFloat(e.rndPrice||e.product.rndPrice)}),0):0},buildRoute:function(t){var e=location;e.origin;return this.$router.resolve({name:"OrderDetailShipment",params:{id:t.id}}).href}}},Lr=Fr,Rr=Object(u["a"])(Lr,Er,Mr,!1,null,null,null),Ar=Rr.exports,Br=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"animated fadeIn"},[r("b-row",[r("b-col",[r("b-card",[r("div",{attrs:{slot:"header"},slot:"header"},[r("span",[r("i",{staticClass:"fa fa-book"}),t._v("\n            Products ("+t._s(t.productCount)+")\n            "),r("b-link",{staticClass:"pull-right",on:{click:t.forceCheckPriceAgain}},[t._v("CW Check Price")])],1)]),this.showCheckPriceProgress?r("div",{staticClass:"mb-5"},[r("p",[t._v("There are "+t._s(this.productsNotCheckedPrice.length)+" products have been out-of-dated, click button 'Start Check Price' to get new price from Chemiswarehourse")]),r("b-progress",{attrs:{value:this.currentProductCheckingIndex,max:this.productsNotCheckedPrice.length,variant:"info",height:"2rem",animated:"","show-value":""}},[r("b-progress-bar",{attrs:{value:this.currentProductCheckingIndex}},[t._v("\n              Progress:\n              "),r("strong",[t._v(t._s(this.currentProductCheckingIndex)+" / "+t._s(this.productsNotCheckedPrice.length))])])],1),r("p",[t._v("#"+t._s(this.currentProductChecking.cwProductId)+" - "+t._s(this.currentProductChecking.name))]),r("b-button",{attrs:{type:"submit",size:"sm",variant:"success"},on:{click:function(e){return t.startCheckPrice(t.data)}}},[r("i",{staticClass:"fa fa-line-chart"}),t._v(" Start Check Price\n          ")])],1):t._e(),r("b-form-group",{attrs:{label:"Show only increase/decrease"}},[r("b-form-checkbox",{attrs:{inline:""},on:{change:t.showOnlyDecreaseChange},model:{value:t.filter.showOnlyDecrease,callback:function(e){t.$set(t.filter,"showOnlyDecrease",e)},expression:"filter.showOnlyDecrease"}},[t._v("Show Only Decrease")]),r("b-form-checkbox",{attrs:{inline:""},on:{change:t.showOnlyIncreaseChange},model:{value:t.filter.showOnlyIncrease,callback:function(e){t.$set(t.filter,"showOnlyIncrease",e)},expression:"filter.showOnlyIncrease"}},[t._v("Show Only Increase")])],1),r("view-port",{scopedSlots:t._u([{key:"desktop",fn:function(){return[r("div",[r("b-table",{ref:"trackingProduct",staticClass:"tracking",attrs:{responsive:"sm",items:t.products,fields:t.fields,small:!0,selectable:"","select-mode":"single"},scopedSlots:t._u([{key:"cell(index)",fn:function(e){return[t._v(t._s(e.index+1))]}},{key:"cell(name)",fn:function(e){return[r("div",{staticClass:"prod-thumbnail-name"},[r("div",{staticClass:"thumbnail"},[e.item.thumbnail?r("img",{attrs:{src:e.item.thumbnail,width:"50px",height:"50px"}}):t._e()]),r("div",{staticClass:"name-2"},[t._v("\n                      "+t._s(e.value)+"\n                      "),r("br"),r("small",[t._v("PID: "+t._s(e.item.cwProductId))])])])]}},{key:"cell(price)",fn:function(e){return[r("del",[t._v(t._s(t._f("currency")(e.item.cwTracking.oldPrice,t.audConfig)))]),t._v("\n                   \n                  "),r("span",{staticStyle:{"font-size":"18px","font-weight":"bold"}},[t._v(t._s(t._f("currency")(e.item.cwTracking.price,t.audConfig)))])]}},{key:"cell(change)",fn:function(e){return["increase"==e.item.cwTracking.priceStatus?r("i",{staticClass:"fa fa-angle-double-up fa-lg",staticStyle:{color:"red","font-size":"24px"},attrs:{"aria-hidden":"true"}}):t._e(),"decrease"==e.item.cwTracking.priceStatus?r("i",{staticClass:"fa fa-angle-double-down fa-lg",staticStyle:{color:"green","font-size":"24px"},attrs:{"aria-hidden":"true"}}):t._e(),t._v("\n                  ("+t._s(e.item.cwTracking.percentage)+"%)\n                ")]}},{key:"cell(lastChecked)",fn:function(e){return[t._v(t._s(t._f("date")(e.item.cwTracking.lastChecked.toDate())))]}},{key:"cell(action)",fn:function(e){return[r("b-button",{staticClass:"mr-1",attrs:{type:"submit",size:"sm",variant:"success"},on:{click:function(r){return t.editProduct(e)}}},[r("i",{staticClass:"fa fa-edit"}),t._v(" Edit\n                  ")])]}}])})],1)]},proxy:!0},{key:"mobile",fn:function(){return[r("b-table",{ref:"trackingProduct",staticClass:"tracking",attrs:{responsive:"sm",items:t.products,fields:t.mobileFields,small:!0,selectable:"","select-mode":"single"},scopedSlots:t._u([{key:"cell(index)",fn:function(e){return[r("div",{staticClass:"row"},[r("div",{staticClass:"col-4",staticStyle:{overflow:"hidden"}},[r("img",{staticStyle:{"margin-left":"-30px"},attrs:{src:e.item.thumbnail,width:"150px",height:"150px"}})]),r("div",{staticClass:"col-8"},[r("strong",[t._v(t._s(e.item.name))]),r("br"),r("del",[t._v(t._s(t._f("currency")(e.item.cwTracking.oldPrice,t.audConfig)))]),r("span",{staticClass:"ml-1",staticStyle:{"font-size":"18px","font-weight":"bold"}},[t._v(t._s(t._f("currency")(e.item.cwTracking.price,t.audConfig)))]),"increase"==e.item.cwTracking.priceStatus?r("i",{staticClass:"fa fa-angle-double-up fa-lg ml-1",staticStyle:{color:"red","font-size":"24px"},attrs:{"aria-hidden":"true"}}):t._e(),"decrease"==e.item.cwTracking.priceStatus?r("i",{staticClass:"fa fa-angle-double-down fa-lg",staticStyle:{color:"green","font-size":"24px"},attrs:{"aria-hidden":"true"}}):t._e(),t._v("\n                    ("+t._s(e.item.cwTracking.percentage)+"%)\n                    "),r("br"),t._v("\n                    Last checked: "+t._s(t._f("date")(e.item.cwTracking.lastChecked.toDate()))+"\n                    "),r("br"),r("b-button",{staticClass:"mt-1",attrs:{type:"submit",size:"sm",variant:"success"},on:{click:function(r){return t.editProduct(e)}}},[r("i",{staticClass:"fa fa-edit"}),t._v(" Edit\n                    ")])],1)])]}}])})]},proxy:!0}])}),r("b-row",{staticClass:"load-more"},[r("b-button",{attrs:{variant:"outline-success",disabled:t.isLoadingMore},on:{click:function(e){return t.loadMoreProduct(e)}}},[t._v("Load more")])],1)],1)],1)],1),r("product-detail",{ref:"productDetail",attrs:{id:"productEdit",item:t.product},on:{productSaved:t.productSaved}})],1)},jr=[],Nr=r("bd86"),qr={name:"Products",components:{productDetail:bt,viewPort:B},data:function(){return{productsNotCheckedPrice:[],currentProductCheckingIndex:0,currentProductChecking:{},products:[],product:{},productBatches:"",useMobileView:!1,searchText:"",pageSize:10,lastVisible:void 0,productCount:0,isLoadingMore:!1,showCheckPriceProgress:!1,fields:[{key:"index",label:"#",class:"index"},Object(Nr["a"])({key:"name",class:"name"},"class","name"),{key:"price",label:"Price",class:"price text-right"},{key:"change",label:"",class:"change text-left"},{key:"lastChecked",label:"Last Checked",class:"text-center last-checked"},{key:"action",label:"Action",class:"action text-right"}],mobileFields:[{key:"index",label:""}],filter:{showOnlyDecrease:!0,showOnlyIncrease:!1}}},mounted:function(){var t=this,e=this;e.useMobileView=window.innerWidth<700,window.addEventListener("resize",(function(){e.useMobileView=window.innerWidth<700})),this.getOutDateProducts(),this.getCheckedProducts(null),this.$fb.counterService.getProductCount().then((function(e){return t.productCount=e}))},watch:{},computed:{},methods:{getCheckedProducts:function(t){var e=this,r=this.$fb.productCollection.where("cwTracking.percentage",">",0).orderBy("cwTracking.percentage","desc");return this.filter.showOnlyDecrease?r=r.where("cwTracking.priceStatus","==","decrease"):this.filter.showOnlyIncrease&&(r=r.where("cwTracking.priceStatus","==","increase")),t&&(r=r.startAfter(t||0)),r.limit(20).get().then((function(t){if(!t.empty)return e.lastVisible=_.last(t.docs),t.forEach((function(t){e.products.push(t.data())})),e.products}))},loadMoreProduct:function(t){var e=this;this.isLoadingMore=!0,this.getCheckedProducts(this.lastVisible).then((function(){return e.isLoadingMore=!1}))},cwCheckPrice:function(){this.$fb.productCollection.where("cwProductId",">","0").orderBy("cwProductId").limit(10).get().then((function(t){return t.empty?[]:_.map(t.docs,(function(t){return t.data()}))})).then((function(t){}))},getOutDateProducts:function(t){var e=this,r=(new Date).setMin();return this.loadCwProducts().then((function(e){return t?e:_.filter(e,(function(t){return!t.cwTracking||!t.cwTracking.lastChecked||t.cwTracking.lastChecked.toDate()<r}))})).then((function(t){e.showCheckPriceProgress=t.length>0,e.productsNotCheckedPrice=t}))},startCheckPrice:function(){this.currentProductCheckingIndex=0,this.currentProductCheckingIndex<this.productsNotCheckedPrice.length&&this.doCheckPrice()},doCheckPrice:function(){var t=this;this.currentProductChecking=this.productsNotCheckedPrice[this.currentProductCheckingIndex];var e=this.currentProductChecking.cwProductId;return this.$http.get(this.appSettings.cwCheckPriceApi.replace("{term}",e)).then((function(r){if(r&&200==r.status&&r.data){var n=r.data,i=_.find(n,(function(t){return parseFloat(t.id)>0}));if(i&&i.id==e){var s=t.decorateData(i,t.currentProductChecking);console.log(s),t.currentProductChecking.cwTracking=s,t.$fb.productCollection.doc(t.currentProductChecking.id).set(t.currentProductChecking)}}t.currentProductCheckingIndex++,t.currentProductCheckingIndex<t.productsNotCheckedPrice.length?window.setTimeout(t.doCheckPrice,200):t.getCheckedProducts()}))},decorateData:function(t,e){t.price=parseFloat(t.Price),t.oldPrice=parseFloat(e.cwPrice),t.lastChecked=new Date;var r=t.price,n=parseFloat(e.cwPrice);return r>n+.5?(t.priceStatus="increase",t.percentage=((r-n)/n*100).toFixed(0)):r<n-.5?(t.priceStatus="decrease",t.percentage=((n-r)/n*100).toFixed(0)):(t.priceStatus="same",t.percentage=0),{price:parseFloat(t.price),oldPrice:parseFloat(t.oldPrice),lastChecked:t.lastChecked,priceStatus:t.priceStatus,percentage:parseFloat(t.percentage)}},loadCwProducts:function(){return this.$fb.productCollection.where("cwProductId",">","0").orderBy("cwProductId").get().then((function(t){return t.empty?[]:_.map(t.docs,(function(t){return t.data()}))}))},editProduct:function(t){t.index;var e=t.item;this.$refs.productDetail.open(Object(b["a"])({},e))},productSaved:function(){},forceCheckPriceAgain:function(){this.getOutDateProducts(!0)},filterCheckedProducts:function(){var t=this;this.$nextTick((function(){t.products=[],t.getCheckedProducts()}))},showOnlyDecreaseChange:function(t){t&&(this.filter.showOnlyIncrease=!1),this.filterCheckedProducts()},showOnlyIncreaseChange:function(t){t&&(this.filter.showOnlyDecrease=!1),this.filterCheckedProducts()}}},Qr=qr,Vr=(r("85d4"),Object(u["a"])(Qr,Br,jr,!1,null,null,null)),zr=Vr.exports,Wr=function(){return Promise.all([r.e("chunk-40f4cc33"),r.e("chunk-e57b56ca")]).then(r.bind(null,"e8c5"))},Ur=function(){return Promise.all([r.e("chunk-40f4cc33"),r.e("chunk-2d0d63f1")]).then(r.bind(null,"7277"))};function Hr(){return[{path:"/",redirect:"/dashboard",name:"Home",component:Wr,meta:{requiresAuth:!0},children:[{path:"dashboard",name:"Dashboard",component:Ur,meta:{title:"Dashboard",requiresAdmin:!0}},{path:"products",name:"Products",component:Ft,meta:{title:"Products",requiresAdmin:!0}},{path:"customers",name:"Customers",component:Nt,meta:{title:"Customers",requiresAdmin:!0}},{path:"customers/:id/orders",name:"CustomerOrders",component:Ht,meta:{title:"Customer Orders",requiresAdmin:!0}},{path:"orders",name:"Orders",component:Zt,meta:{title:"Orders",requiresAdmin:!0},children:[{path:":id/statistic",name:"OrderStatistic",component:yr}]},{path:"orders/:id",name:"OrderDetail",component:Ve,meta:{title:"Order Detail",requiresAdmin:!0}},{path:"orders/:id/collectionpage",name:"OrderDetailCollection",component:Ke,meta:{title:"Order Detail Collection",requiresAdmin:!0}},{path:"orders/:id/shipment",name:"OrderDetailShipment",component:pr,meta:{title:"Order Detail Shipment"}},{path:"trackingPrices",name:"TrackingPrices",component:zr,meta:{title:"Tracking Prices",requiresAdmin:!0}},{path:"shipments",name:"Shipments",component:Ar,meta:{title:"Shipments"}},{path:"utils",name:"UtilsPage",component:xr,meta:{title:"Utils",requiresAdmin:!0}}]},{path:"/login",name:"Login",component:Dr,meta:{requiresAuth:!1,title:"Login"}}]}n["default"].use(m["a"]);var Yr=new m["a"]({mode:"hash",linkActiveClass:"open active",scrollBehavior:function(){return{y:0}},routes:Hr()});Yr.beforeEach((function(t,e,r){var n=h.a.auth().currentUser,i=t.matched.some((function(t){return t.meta.requiresAuth})),s=t.matched.some((function(t){return t.meta.requiresAdmin})),o=n&&"gzuRo62QEyMCvgEHchh91vOH4RW2"==n.uid;document.title=t.matched.reduce((function(t,e){return e.meta.title?e.meta.title:""}),""),i&&!n?r("/login"):s&&!o?r("/shipments"):r()}));var Kr=Yr;r("f576");n["default"].filter("date",(function(t){return(t.getDate()+"").padStart(2,0)+"/"+(t.getMonth()+1+"").padStart(2,0)+"/"+t.getFullYear()}));var Jr=r("bc3a"),Gr=r.n(Jr),Xr=(r("551c"),r("e71f"),{apiKey:"AIzaSyBpo4IlT4YWHPf6Kb1ws6KgzfbxQurgPIQ",authDomain:"chemistorder-fac70.firebaseapp.com",databaseURL:"https://chemistorder-fac70.firebaseio.com",projectId:"chemistorder-fac70",storageBucket:"chemistorder-fac70.appspot.com",messagingSenderId:"1018979807432",appId:"1:1018979807432:web:7f91bee1f9f50d792e35fd"});h.a.initializeApp(Xr);var Zr=h.a.firestore(),tn=h.a.auth(),en=tn.currentUser,rn=Zr.collection("products"),nn=Zr.collection("customers"),sn=Zr.collection("orders"),on=Zr.collection("counter"),an=void 0;function cn(){return new Promise((function(t){an?t(an):on.limit(1).onSnapshot((function(e){return e.forEach((function(e){an=e.data(),t(an)}))}))}))}cn();var un={getCustomerCount:function(){var t=Object(Vt["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,cn();case 2:return t.abrupt("return",an.customerCount);case 3:case"end":return t.stop()}}),t)})));function e(){return t.apply(this,arguments)}return e}(),increaseCustomer:function(){var t=Object(Vt["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,cn();case 2:return an.customerCount++,on.doc(an.id).set(an),t.abrupt("return",an.customerCount);case 5:case"end":return t.stop()}}),t)})));function e(){return t.apply(this,arguments)}return e}(),decreaseCustomer:function(){var t=Object(Vt["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,cn();case 2:return an.customerCount--,on.doc(an.id).set(an),t.abrupt("return",an.customerCount);case 5:case"end":return t.stop()}}),t)})));function e(){return t.apply(this,arguments)}return e}(),getProductCount:function(){var t=Object(Vt["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,cn();case 2:return t.abrupt("return",an.productCount);case 3:case"end":return t.stop()}}),t)})));function e(){return t.apply(this,arguments)}return e}(),increaseProduct:function(){var t=Object(Vt["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,cn();case 2:return an.productCount++,on.doc(an.id).set(an),t.abrupt("return",an.productCount);case 5:case"end":return t.stop()}}),t)})));function e(){return t.apply(this,arguments)}return e}(),decreaseProduct:function(){var t=Object(Vt["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,cn();case 2:return an.productCount--,on.doc(an.id).set(an),t.abrupt("return",an.productCount);case 5:case"end":return t.stop()}}),t)})));function e(){return t.apply(this,arguments)}return e}(),getOrderCount:function(){var t=Object(Vt["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,cn();case 2:return t.abrupt("return",an.orderCount);case 3:case"end":return t.stop()}}),t)})));function e(){return t.apply(this,arguments)}return e}(),increaseOrder:function(){var t=Object(Vt["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,cn();case 2:return an.orderCount++,on.doc(an.id).set(an),t.abrupt("return",an.orderCount);case 5:case"end":return t.stop()}}),t)})));function e(){return t.apply(this,arguments)}return e}(),decreaseOrder:function(){var t=Object(Vt["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,cn();case 2:return an.orderCount--,on.doc(an.id).set(an),t.abrupt("return",an.orderCount);case 5:case"end":return t.stop()}}),t)})));function e(){return t.apply(this,arguments)}return e}()},ln={db:Zr,auth:tn,isAdmin:function(){return tn.currentUser&&"gzuRo62QEyMCvgEHchh91vOH4RW2"==tn.currentUser.uid},currentUser:en,productCollection:rn,customerCollection:nn,orderCollection:sn,counterCollection:on,counterService:un},dn=ln.db.collection("counter"),mn=void 0;function pn(){return new Promise((function(t){mn?t(mn):dn.limit(1).onSnapshot((function(e){return e.forEach((function(e){mn=e.data(),t(mn)}))}))}))}pn();var hn={getCustomerCount:function(){var t=Object(Vt["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,pn();case 2:return t.abrupt("return",mn.customerCount);case 3:case"end":return t.stop()}}),t)})));function e(){return t.apply(this,arguments)}return e}(),increaseCustomer:function(){var t=Object(Vt["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,pn();case 2:return mn.customerCount++,dn.doc(mn.id).set(mn),t.abrupt("return",mn.customerCount);case 5:case"end":return t.stop()}}),t)})));function e(){return t.apply(this,arguments)}return e}(),decreaseCustomer:function(){var t=Object(Vt["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,pn();case 2:return mn.customerCount--,dn.doc(mn.id).set(mn),t.abrupt("return",mn.customerCount);case 5:case"end":return t.stop()}}),t)})));function e(){return t.apply(this,arguments)}return e}(),getProductCount:function(){var t=Object(Vt["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,pn();case 2:return t.abrupt("return",mn.productCount);case 3:case"end":return t.stop()}}),t)})));function e(){return t.apply(this,arguments)}return e}(),increaseProduct:function(){var t=Object(Vt["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,pn();case 2:return mn.productCount++,dn.doc(mn.id).set(mn),t.abrupt("return",mn.productCount);case 5:case"end":return t.stop()}}),t)})));function e(){return t.apply(this,arguments)}return e}(),decreaseProduct:function(){var t=Object(Vt["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,pn();case 2:return mn.productCount--,dn.doc(mn.id).set(mn),t.abrupt("return",mn.productCount);case 5:case"end":return t.stop()}}),t)})));function e(){return t.apply(this,arguments)}return e}(),getOrderCount:function(){var t=Object(Vt["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,pn();case 2:return t.abrupt("return",mn.orderCount);case 3:case"end":return t.stop()}}),t)})));function e(){return t.apply(this,arguments)}return e}(),increaseOrder:function(){var t=Object(Vt["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,pn();case 2:return mn.orderCount++,dn.doc(mn.id).set(mn),t.abrupt("return",mn.orderCount);case 5:case"end":return t.stop()}}),t)})));function e(){return t.apply(this,arguments)}return e}(),decreaseOrder:function(){var t=Object(Vt["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,pn();case 2:return mn.orderCount--,dn.doc(mn.id).set(mn),t.abrupt("return",mn.orderCount);case 5:case"end":return t.stop()}}),t)})));function e(){return t.apply(this,arguments)}return e}()},fn=(ln.db.collection("product"),{getProducts:function(t,e,r){var n=this;return this.$fb.productCollection.orderBy("name").startAfter(this.lastVisible||0).limit(this.pageSize).get().then((function(t){t.empty||(n.lastVisible=_.last(t.docs),t.forEach((function(t){n.products.push(t.data())})))}))}}),vn=ln.db.collection("orders");function bn(t){return gn.apply(this,arguments)}function gn(){return gn=Object(Vt["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.abrupt("return",vn.doc(e).get().then((function(t){return t.data()})));case 1:case"end":return t.stop()}}),t)}))),gn.apply(this,arguments)}function yn(t){return Cn.apply(this,arguments)}function Cn(){return Cn=Object(Vt["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.abrupt("return",vn.doc(e).collection("orderItems").get().then((function(t){return 0==t.empty?t.docs.map((function(t){return t.data()})):[]})));case 1:case"end":return t.stop()}}),t)}))),Cn.apply(this,arguments)}var _n={getOrderAndItemsByOrderId:function(){var t=Object(Vt["a"])(regeneratorRuntime.mark((function t(e){var r,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,bn(e);case 2:return r=t.sent,t.next=5,yn(e);case 5:return n=t.sent,t.abrupt("return",{order:r,orderItems:n});case 7:case"end":return t.stop()}}),t)})));function e(e){return t.apply(this,arguments)}return e}(),setOrderItem:function(){var t=Object(Vt["a"])(regeneratorRuntime.mark((function t(e,r){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!r.id){t.next=6;break}return r.dateModified=new Date,t.next=4,vn.doc(e).collection("orderItems").doc(r.id).set(r);case 4:t.next=11;break;case 6:return r.dateCreated=new Date,n=vn.doc(e).collection("orderItems").doc(),r.id=n.id,t.next=11,n.set(r);case 11:return t.abrupt("return",r);case 12:case"end":return t.stop()}}),t)})));function e(e,r){return t.apply(this,arguments)}return e}(),deleteOrderItem:function(t,e){return vn.doc(t).collection("orderItems").doc(e).delete()}},kn={counterService:hn,productService:fn,orderService:_n},Pn=r("7345"),wn=r.n(Pn);n["default"].prototype.$fb=ln,n["default"].prototype.$fbServices=kn,n["default"].prototype.vndConfig={symbol:"VND",thousandsSeparator:",",fractionCount:0,fractionSeparator:".",symbolPosition:"after",symbolSpacing:!0},n["default"].prototype.audConfig={symbol:"$",thousandsSeparator:",",fractionCount:2,fractionSeparator:".",symbolPosition:"front",symbolSpacing:!1},n["default"].prototype.$http=Gr.a,n["default"].prototype.appSettings={commissionRate:1.1,vndExchageRate:16500,ctvCommissionRate:1.08,buyingFee:2,cwCheckPriceApi:"http://45.77.96.178/lamdam?term={term}",cwProductThumbnailUrl150:"https://static.chemistwarehouse.com.au/ams/media/pi/{id}/hero_150.jpg",cwBuyProductUrl:"https://www.chemistwarehouse.com.au/buy/{id}",doanvienvyUserId:"RIHc56zsbXehz0MJx6Q1mLzW1kq2",duylamlnUserId:"gzuRo62QEyMCvgEHchh91vOH4RW2"},n["default"].use(i["a"]),n["default"].use(wn.a);var xn="";ln.auth.onAuthStateChanged((function(){xn||(xn=new n["default"]({el:"#app",router:Kr,template:"<App/>",components:{App:d}}))}))},"5c0b":function(t,e,r){"use strict";var n=r("e332"),i=r.n(n);i.a},"5d28":function(t,e,r){},6210:function(t,e,r){"use strict";var n=r("5d28"),i=r.n(n);i.a},"6b63":function(t,e,r){"use strict";var n=r("cdcb"),i=r.n(n);i.a},"7c18":function(t,e,r){},"83ed":function(t,e,r){},"85d4":function(t,e,r){"use strict";var n=r("3dbb"),i=r.n(n);i.a},"8f38":function(t,e,r){"use strict";var n=r("f5bb"),i=r.n(n);i.a},a3b2:function(t,e,r){"use strict";var n=r("20d5"),i=r.n(n);i.a},b12d:function(t,e,r){"use strict";var n=r("7c18"),i=r.n(n);i.a},b96f:function(t,e,r){"use strict";var n=r("c932"),i=r.n(n);i.a},bebb:function(t,e,r){"use strict";var n=r("ddd9"),i=r.n(n);i.a},c551:function(t,e,r){},c932:function(t,e,r){},cdc0:function(t,e,r){"use strict";var n=r("c551"),i=r.n(n);i.a},cdcb:function(t,e,r){},d8da:function(t,e,r){"use strict";var n=r("83ed"),i=r.n(n);i.a},ddd9:function(t,e,r){},e332:function(t,e,r){},f5bb:function(t,e,r){}});
//# sourceMappingURL=app.6f38fda0.js.map